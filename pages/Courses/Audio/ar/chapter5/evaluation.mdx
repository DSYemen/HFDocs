# ููุงููุณ ุงูุชูููู ูุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงู

ุฅุฐุง ููุช ุนูู ุฏุฑุงูุฉ ุจู [ูุณุงูุฉ ูููููุดุชุงูู](https://en.wikipedia.org/wiki/Levenshtein_distance) ูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉุ ูุณุชููู ููุงููุณ ุชูููู ุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงู ูุฃูููุฉ ูุฏูู! ูุง ุชููู ุฅุฐุง ูู ุชูู ูุฐููุ ุณูุดุฑุญูุง ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ ููุชุฃูุฏ ูู ูููู ููุฎุชูู ุงูููุงููุณ ููุนุฑูุฉ ูุง ุชุนููู.

ุนูุฏ ุชูููู ุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงูุ ููุงุฑู ุชูุจุคุงุช ุงููุธุงู ุจุงููุตูุต ุงููุณุชูุฏูุฉุ ููููู ุจุชูุถูุญ ุฃู ุฃุฎุทุงุก ููุฌูุฏุฉ. ูุตูู ูุฐู ุงูุฃุฎุทุงุก ุฅูู ูุงุญุฏุฉ ูู ุซูุงุซ ูุฆุงุช:

1. ุงูุงุณุชุจุฏุงูุงุช (S): ุญูุซ ููุชุจ ุงููููุฉ **ุงูุฎุทุฃ** ูู ุชูุจุคูุง ("sit" ุจุฏูุงู ูู "sat")
2. ุงูุฅุถุงูุงุช (I): ุญูุซ ูุถูู **ูููุฉ ุฅุถุงููุฉ** ูู ุชูุจุคูุง
3. ุงูุญุฐู (D): ุญูุซ **ูุญุฐู ูููุฉ** ูู ุชูุจุคูุง

ูุฐู ุงููุฆุงุช ูู ุงูุฃุฎุทุงุก ูู ููุณูุง ูุฌููุน ููุงููุณ ุงูุชุนุฑู ุนูู ุงูููุงู. ูุง ูุฎุชูู ูู ุงููุณุชูู ุงูุฐู ูุญุณุจ ููู ูุฐู ุงูุฃุฎุทุงุก: ูููููุง ุญุณุงุจูุง ุนูู ูุณุชูู _ุงููููุฉ_ ุฃู ุนูู ูุณุชูู _ุงูุดุฎุตูุฉ_.

ุณูุณุชุฎุฏู ูุซุงูุงู ูุณุชูุฑุงู ููู ุชุนุฑูู ูู ุชุนุฑููุงุช ุงูููุงููุณ. ููุงุ ูุฏููุง ุชุณูุณู ูุต _ุงูุญูููุฉ ุงูุฃุฑุถูุฉ_ ุฃู _ุงููุฑุฌุนู_:

```python
reference = "the cat sat on the mat"
```

ูุชุณูุณู ูุชููุน ูู ูุธุงู ุงูุชุนุฑู ุนูู ุงูููุงู ุงูุฐู ูุญุงูู ุชููููู:

```python
prediction = "the cat sit on the"
```

ูููููุง ุฃู ูุฑู ุฃู ุงูุชูุจุค ูุฑูุจ ุฌุฏุงูุ ูููู ุจุนุถ ุงููููุงุช ููุณุช ุตุญูุญุฉ ุชูุงูุงู. ุณูููู ูุฐุง ุงูุชูุจุค ููุงุจู ุงููุฑุฌุน ุจุงููุณุจุฉ ูููุงููุณ ุงูุชุนุฑู ุนูู ุงูููุงู ุงูุซูุงุซุฉ ุงูุฃูุซุฑ ุดุนุจูุฉ ููุฑู ููุน ุงูุฃุฑูุงู ุงูุชู ูุญุตู ุนูููุง ููู ูููุง.

## ูุนุฏู ุฎุทุฃ ุงููููุฉ
ูุนุฏ ูููุงุณ *ูุนุฏู ุฎุทุฃ ุงููููุฉ (WER)* ุงููููุงุณ 'ุงููุนูู' ูุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงู. ููู ูุญุณุจ ุงูุงุณุชุจุฏุงูุงุช ูุงูุฅุถุงูุงุช ูุงูุญุฐู ุนูู ูุณุชูู *ุงููููุฉ*. ููุฐุง ูุนูู ุฃู ุงูุฃุฎุทุงุก ูุชู ุชูุถูุญูุง ุนูู ุฃุณุงุณ ูููุฉ ุจูููุฉ. ุฎุฐ ูุซุงููุง:


| ุงููุฑุฌุน:  | the | cat | sat     | on  | the | mat |
|-------------|-----|-----|---------|-----|-----|-----|
| ุงูุชูุจุค: | the | cat | **sit** | on  | the |     |  |
| ุงูุชุตููู:      | โ   | โ   | S       | โ   | โ   | D   |

ููุงุ ูุฏููุง:
* 1 ุงุณุชุจุฏุงู ("sit" ุจุฏูุงู ูู "sat")
* 0 ุฅุถุงูุงุช
* 1 ุญุฐู ("mat" ููููุฏ)

ูุฐุง ูุนุทู 2 ุฃุฎุทุงุก ูู ุงููุฌููุน. ููุญุตูู ุนูู ูุนุฏู ุงูุฎุทุฃ ูุฏููุงุ ููุณู ุนุฏุฏ ุงูุฃุฎุทุงุก ุนูู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช ูู ูุฑุฌุนูุง (N)ุ ูุงูุฐู ูู ูุฐุง ุงููุซุงู ูู 6:

$$
\begin{aligned}
WER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 1}{6} \\
&= 0.333
\end{aligned}
$$

ุญุณูุงู! ูุฐูู ูุฏููุง WER ูุจูุบ 0.333ุ ุฃู 33.3%. ูุงุญุธ ููู ุฃู ุงููููุฉ "sit" ุจูุง ุญุฑู ูุงุญุฏ ููุท ุฎุงุทุฆุ ูููู ุงููููุฉ ุจุฃููููุง ุชู ูุถุน ุนูุงูุฉ ุฎุงุทุฆุฉ ุนูููุง. ูุฐู ุณูุฉ ูููุฒุฉ ูู WER: ูุชู ูุนุงูุจุฉ ุฃุฎุทุงุก ุงูุชูุฌุฆุฉ ุจุดุฏุฉุ ุจุบุถ ุงููุธุฑ ุนู ูุฏู ุจุณุงุทุชูุง.

ุชู ุชุนุฑูู WER ุจุญูุซ ูููู *ุงูุฃูู ูู ุงูุฃูุถู*: ูุนูู WER ุงูููุฎูุถ ูุฌูุฏ ุฃุฎุทุงุก ุฃูู ูู ุชูุจุคูุงุ ูุฐุง ูุฅู ูุธุงู ุงูุชุนุฑู ุนูู ุงูููุงู ุงููุซุงูู ุณูููู ูุฏูู WER ุตูุฑ (ุจุฏูู ุฃุฎุทุงุก).

ุฏุนูุง ูุฑู ููู ูููููุง ุญุณุงุจ WER ุจุงุณุชุฎุฏุงู ๐ค Evaluate. ุณูุญุชุงุฌ ุฅูู ุญุฒูุชูู ูุญุณุงุจ ูููุงุณ WER ูุฏููุง: ๐ค Evaluate ูููุงุฌูุฉ ุงูุจุฑูุฌูุฉุ ู JIWER ููููุงู ุจุงูุนูู ุงูุดุงู ูุชุดุบูู ุงูุญุณุงุจ:
```
pip install --upgrade evaluate jiwer
```

ุฑุงุฆุน! ูููููุง ุงูุขู ุชุญููู ูููุงุณ WER ูุญุณุงุจ ุงูุฑูู ููุซุงููุง:

```python
from evaluate import load

wer_metric = load("wer")

wer = wer_metric.compute(references=[reference], predictions=[prediction])

print(wer)
```
**ุทุจุงุนุฉ ุงูุฅุฎุฑุงุฌ:**
```
0.3333333333333333
```
**ุทุจุงุนุฉ ุงููุฎุฑุฌุงุช:**
```
0.3333333333333333
```

0.33ุ ุฃู 33.3%ุ ููุง ูู ูุชููุน! ุงูุขู ูุนุฑู ูุง ูุฌุฑู ุชุญุช ุงูุบุทุงุก ูุน ุญุณุงุจ WER ูุฐุง.

ุงูุขูุ ููุงู ุดูุก ูุญูุฑ ููุบุงูุฉ... ูุง ูู ุงูุญุฏ ุงูุฃุนูู ูู WER ูู ุฑุฃููุ ูุฏ ุชุชููุน ุฃู ูููู 1 ุฃู 100%ุ ุฃููุณ ูุฐููุ ูุง! ูุฃู WER ูู ูุณุจุฉ ุงูุฃุฎุทุงุก ุฅูู ุนุฏุฏ ุงููููุงุช (N)ุ ููุง ููุฌุฏ ุญุฏ ุฃุนูู ูู WER!
ุฏุนูุง ูุฃุฎุฐ ูุซุงููุง ุญูุซ ูุชููุน 10 ูููุงุช ูุงููุฏู ูุญุชูู ููุท ุนูู ูููุชูู. ุฅุฐุง ูุงูุช ุฌููุน ุชูุจุคุงุชูุง ุฎุงุทุฆุฉ (10 ุฃุฎุทุงุก)ุ
ูุณูุญุตู ุนูู WER ูุณุงูู 10/2 = 5ุ ุฃู 500%! ูุฐุง ุดูุก ูุฌุจ ูุถุนู ูู ุงูุงุนุชุจุงุฑ ุฅุฐุง ููุช ุจุชุฏุฑูุจ ูุธุงู ASR ูุฑุฃูุช WER ุฃูุซุฑ ูู
100%. ุนูู ุงูุฑุบู ูู ุฃูู ุฅุฐุง ููุช ุชุฑู ูุฐุงุ ููู ุงููุญุชูู ุฃู ูููู ููุงู ุฎุทุฃ ูุง... ๐

## ุฏูุฉ ุงููููุฉ

ูููููุง ููุจ WER ููุนุทููุง ูููุงุณูุง ูููู ููู *ุงูุฃุนูู ูู ุงูุฃูุถู*. ุจุฏูุงู ูู ููุงุณ ูุนุฏู ุฎุทุฃ ุงููููุฉุ
ูููููุง ููุงุณ *ุฏูุฉ ุงููููุฉ (WAcc)* ููุธุงููุง:

$$
\begin{equation}
WAcc = 1 - WER \nonumber
\end{equation}
$$

ูุชู ููุงุณ WAcc ุฃูุถูุง ุนูู ูุณุชูู ุงููููุฉุ ุฅูู ูุฌุฑุฏ ุฅุนุงุฏุฉ ุตูุงุบุฉ WER ููููุงุณ ุฏูุฉ ุจุฏูุงู ูู ูููุงุณ ุฎุทุฃ. ูุงุฏุฑูุง ูุง ูุชู ุฐูุฑ WAcc ูู ุฃุฏุจูุงุช ุงูููุงู - ูููุฑ ูู ุชูุจุคุงุช ูุธุงููุง ูู ุญูุซ
ุฃุฎุทุงุก ุงููููุงุชุ ูุจุงูุชุงูู ููุถู ููุงููุณ ูุนุฏู ุงูุฎุทุฃ ุงูุชู ุชุฑุชุจุท ุฃูุซุฑ ุจูุฐู ุงูุฃููุงุน ูู ุนูุงูุงุช ุงูุฎุทุฃ.

## ูุนุฏู ุฎุทุฃ ุงูุญุฑู

ูุจุฏู ูู ุงูุธูู ุฃููุง ุตูููุง ุงููููุฉ "sit" ุจุงููุงูู ุนูู ุฃููุง ุฎุงุทุฆุฉ ุนูุฏูุง ูุงู ูู ุงููุงูุน ุญุฑู ูุงุญุฏ ููุท ุบูุฑ ุตุญูุญ.
ุฐูู ูุฃููุง ููุง ูููู ูุธุงููุง ุนูู ูุณุชูู ุงููููุฉุ ูุจุงูุชุงูู ูุถุน ุนูุงูุงุช ุนูู ุงูุฃุฎุทุงุก ูููุฉ ุจูููุฉ.
*ูุนุฏู ุฎุทุฃ ุงูุญุฑู (CER)* ูููู ุงูุฃูุธูุฉ ุนูู *ูุณุชูู ุงูุญุฑู*. ูุฐุง ูุนูู ุฃููุง ููุณู ูููุงุชูุง ุฅูู
ุญุฑูููุง ุงููุฑุฏูุฉุ ููุถุน ุนูุงูุงุช ุนูู ุงูุฃุฎุทุงุก ุญุฑููุง ุจุญุฑู:

| ุงููุฑุฌุน:  | t   | h   | e   |     | c   | a   | t   |     | s   | a     | t   |     | o   | n   |     | t   | h   | e   |     | m   | a   | t   |
|-------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| ุงูุชูุจุค: | t   | h   | e   |     | c   | a   | t   |     | s   | **i** | t   |     | o   | n   |     | t   | h   | e   |     |     |     |     |
| ุงูุชุตููู:      | โ   | โ   | โ   |     | โ   | โ   | โ   |     | โ   | S     | โ   |     | โ   | โ   |     | โ   | โ   | โ   |     | D   | D   | D   |

ูููููุง ุงูุขู ุฃู ูุฑู ุฃูู ุจุงููุณุจุฉ ููููุฉ "sit"ุ ูุชู ูุถุน ุนูุงูุฉ "s" ู "t" ุนูู ุฃููุง ุตุญูุญุฉ. ููุท "i" ูู ุงูุฐู ุชู ุชุตูููู ุนูู ุฃูู ุฎุทุฃ ุงุณุชุจุฏุงู (S). ูุจุงูุชุงููุ ููุงูุฆ ูุธุงููุง ุนูู ุงูุชูุจุค ุงูุฌุฒุฆู ุงูุตุญูุญ ๐ค

ูู ูุซุงููุงุ ูุฏููุง ุงุณุชุจุฏุงู ุญุฑู ูุงุญุฏุ 0 ุฅุฏุฎุงูุงุชุ ู3 ุนูููุงุช ุญุฐู. ูู ุงููุฌููุนุ ูุฏููุง 14 ุญุฑููุง. ูุฐููุ ูุฅู CER ูุฏููุง ูู:

$$
\begin{aligned}
CER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 3}{14} \\
&= 0.286
\end{aligned}
$$

ุตุญูุญ! ูุฏููุง CER ูุณุงูู 0.286ุ ุฃู 28.6%. ูุงุญุธ ููู ุฃู ูุฐุง ุฃูู ูู WER ูุฏููุง - ููุฏ ุนุงูุจูุง ุฎุทุฃ ุงููุฌุงุก ุจุดูู ุฃูู.

## ุฃู ูููุงุณ ูุฌุจ ุฃู ุฃุณุชุฎุฏูุ

ุจุดูู ุนุงูุ ูุชู ุงุณุชุฎุฏุงู WER ุฃูุซุฑ ุจูุซูุฑ ูู CER ูุชูููู ุฃูุธูุฉ ุงูููุงู. ูุฐูู ูุฃู WER ูุชุทูุจ ุฃู ูููู ูุฏู ุงูุฃูุธูุฉ
ููู ุฃูุจุฑ ูุณูุงู ุงูุชูุจุคุงุช. ูู ูุซุงููุงุ "sit" ูู ุฒูู ุฎุงุทุฆ. ูุธุงู
ูููู ุงูุนูุงูุฉ ุจูู ุงููุนู ูุฒูู ุงูุฌููุฉ ูุงู ุณูุชูุจุฃ ุจุฒูู ุงููุนู ุงูุตุญูุญ
"sat". ูุฑูุฏ ุชุดุฌูุน ูุฐุง ุงููุณุชูู ูู ุงูููู ูู ุฃูุธูุฉ ุงูููุงู ูุฏููุง. ูุฐูู ุนูู ุงูุฑุบู ูู ุฃู WER ุฃูู ุชุณุงูุญูุง ูู
CERุ ุฅูุง ุฃูู ุฃูุถูุง ุฃูุซุฑ ููุงุกูุฉ ูุฃููุงุน ุงูุฃูุธูุฉ ุงููููููุฉ ุงูุชู ูุฑูุฏ ุชุทููุฑูุง. ูุฐููุ ุนุงุฏุฉ ูุง ูุณุชุฎุฏู
WER ููุดุฌุนู ุนูู ุฐูู ุฃูุถูุง! ููุน ุฐููุ ููุงู ุธุฑูู ูุง ูููู ูููุง ุงุณุชุฎุฏุงู WER.
ูุบุงุช ูุนููุฉุ ูุซู ุงููุงูุฏุฑูู ูุงููุงุจุงููุฉุ ููุณ ูุฏููุง ููููู 'ุงููููุงุช'ุ ูุจุงูุชุงูู ูุฅู WER ูุง ูุนูู ูู. ููุงุ ูุนูุฏ
ุฅูู ุงุณุชุฎุฏุงู CER.

ูู ูุซุงููุงุ ูู ูุณุชุฎุฏู ุณูู ุฌููุฉ ูุงุญุฏุฉ ุนูุฏ ุญุณุงุจ WER. ุนุงุฏุฉ ูุง ูุณุชุฎุฏู ูุฌููุนุฉ ุงุฎุชุจุงุฑ ูุงููุฉ ุชุชููู
ูู ุนุฏุฉ ุขูุงู ูู ุงูุฌูู ุนูุฏ ุชูููู ูุธุงู ุญูููู. ุนูุฏ ุงูุชูููู ุนูู ุนุฏุฉ ุฌููุ ูููู ุจุฌูุน S ู I ู D
ู N ุนุจุฑ ุฌููุน ุงูุฌููุ ุซู ูุญุณุจ WER ููููุง ููุตูุบุฉ ุงููุญุฏุฏุฉ ุฃุนูุงู. ูุฐุง ูุนุทู ุชูุฏูุฑูุง ุฃูุถู
ูู WER ููุจูุงูุงุช ุบูุฑ ุงููุฑุฆูุฉ.

## ุงูุชุทุจูุน

ุฅุฐุง ูููุง ุจุชุฏุฑูุจ ูููุฐุฌ ASR ุนูู ุจูุงูุงุช ูุน ุนูุงูุงุช ุงูุชุฑููู ูุงูุญุงูุฉุ ูุณูุชุนูู ุงูุชูุจุค ุจุงูุญุงูุฉ ูุนูุงูุงุช ุงูุชุฑููู ูู
ูุตูุตู. ูุฐุง ุฑุงุฆุน ุนูุฏูุง ูุฑูุฏ ุงุณุชุฎุฏุงู ูููุฐุฌูุง ูุชุทุจููุงุช ุงูุชุนุฑู ุงููุนูู ุนูู ุงูููุงูุ ูุซู
ูุตูุต ุงูุงุฌุชูุงุนุงุช ุฃู ุงูุฅููุงุกุ ุญูุซ ุณุชููู ุงููุตูุต ุงููุชููุนุฉ ูููุณูุฉ ุจุงููุงูู ูุน ุนูุงูุงุช ุงูุชุฑููู ูุงูุญุงูุฉุ
ุฃุณููุจ ูุดุงุฑ ุฅููู ุจุงุณู *ุงูุฃุฑุซูุบุฑุงูู*.

ููุน ุฐููุ ูุฏููุง ุฃูุถูุง ุฎูุงุฑ *ุชุทุจูุน* ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฅุฒุงูุฉ ุฃู ุญุงูุฉ ูุนูุงูุงุช ุชุฑููู. ูุฌุนู ุชุทุจูุน ูุฌููุนุฉ ุงูุจูุงูุงุช ูููุฉ ุงูุชุนุฑู ุนูู ุงูููุงู ุฃุณูู: ูู ูุนุฏ ุงููููุฐุฌ ุจุญุงุฌุฉ ุฅูู ุงูุชูููุฒ ุจูู ุงูุฃุญุฑู ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ
ุฃู ุงูุชูุจุค ุจุนูุงูุงุช ุงูุชุฑููู ูู ุจูุงูุงุช ุงูุตูุช ูุญุฏูุง (ูุซูุ ูุง ูู ุงูุตูุช ุงูุฐู ูุตูุนู ุงููุงุตูุฉ ุงูููููุทุฉุ).
ุจุณุจุจ ูุฐุงุ ุชููู ูุนุฏูุงุช ุฎุทุฃ ุงููููุฉ ุฃูู ุจุดูู ุทุจูุนู (ููุง ูุนูู ุฃู ุงููุชุงุฆุฌ ุฃูุถู). ุชูุถุญ ูุฑูุฉ Whisper ุงูุชุฃุซูุฑ ุงููุจูุฑ
ุงูุฐู ูููู ุฃู ูุญุฏุซู ุชุทุจูุน ุงููุตูุต ุนูู ูุชุงุฆุฌ WER (*ุฑุงุฌุน* ุงููุณู 4.4 ูู [ูุฑูุฉ Whisper](https://cdn.openai.com/papers/whisper.pdf)).
ุนูู ุงูุฑุบู ูู ุฃููุง ูุญุตู ุนูู WER ุฃููุ ุฅูุง ุฃู ุงููููุฐุฌ ููุณ ุจุงูุถุฑูุฑุฉ ุฃูุถู ููุฅูุชุงุฌ. ูุฌุนู ุนุฏู ูุฌูุฏ ุญุงูุฉ ูุนูุงูุงุช ุชุฑููู ุงููุต ุงููุชููุน ูู ุงููููุฐุฌ
ุฃุตุนุจ ุจูุซูุฑ ูู ุงููุฑุงุกุฉ. ุฎุฐ ุงููุซุงู ูู [ุงููุณู ุงูุณุงุจู](asr_models)ุ ุญูุซ ูููุง ุจุชุดุบูู
Wav2Vec2 ู Whisper ุนูู ููุณ ุงูุนููุฉ ุงูุตูุชูุฉ ูู ูุฌููุนุฉ ุจูุงูุงุช LibriSpeech. ูุง ูุชูุจุฃ ูููุฐุฌ Wav2Vec2 ุจุนูุงูุงุช ุงูุชุฑููู
ููุง ุจุงูุญุงูุฉุ ูู ุญูู ูุชูุจุฃ Whisper ุจูููููุง. ุนูุฏ ููุงุฑูุฉ ุงููุตูุต ุฌูุจูุง ุฅูู ุฌูุจุ ูุฑู ุฃู ูุต Whisper
ุฃุณูู ูู ุงููุฑุงุกุฉ:

```
Wav2Vec2:  HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAUS AND ROSE BEEF LOOMING BEFORE US SIMALYIS DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND
Whisper:   He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind.
```

ูุต Whisper ุฃุฑุซูุบุฑุงูู ูุจุงูุชุงูู ุฌุงูุฒ - ุฅูู ููุณู ููุง ูุชููุน ููุต ูุตูุต ุงูุงุฌุชูุงุน
ุฃู ูุต ุงูุฅููุงุก ูุน ูู ูู ุนูุงูุงุช ุงูุชุฑููู ูุงูุญุงูุฉ. ุนูู ุงูุนูุณุ ุณูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุนุงูุฌุฉ ูุงุญูุฉ ุฅุถุงููุฉ
ูุงุณุชุนุงุฏุฉ ุนูุงูุงุช ุงูุชุฑููู ูุงูุญุงูุฉ ูู ุชูุจุคุงุช Wav2Vec2 ุฅุฐุง ุฃุฑุฏูุง ุงุณุชุฎุฏุงููุง ูุชุทุจููุงุช ุงููุตุจ.

ููุงู ูุณุท ุณุนูุฏ ุจูู ุงูุชุทุจูุน ูุนุฏู ุงูุชุทุจูุน: ูููููุง ุชุฏุฑูุจ ุฃูุธูุชูุง ุนูู ูุตูุต ุฃุฑุซูุบุฑุงููุฉุ
ุซู ุชุทุจูุน ุงูุชูุจุคุงุช ูุงูุฃูุฏุงู ูุจู ุญุณุงุจ WER. ุจูุฐู ุงูุทุฑููุฉุ ูููู ุจุชุฏุฑูุจ ุฃูุธูุชูุง ุนูู ุงูุชูุจุค ุจูุต ูููุณู ุจุงููุงููุ
ููููุง ูุณุชููุฏ ุฃูุถูุง ูู ุชุญุณููุงุช WER ุงูุชู ูุญุตู ุนูููุง ูู ุฎูุงู ุชุทุจูุน ุงููุตูุต.

ุชู ุฅุตุฏุงุฑ ูููุฐุฌ Whisper ูุน ุชุทุจูุน ูุนุงูุฌ ุชุทุจูุน ุงูุญุงูุฉ ูุนูุงูุงุช ุงูุชุฑููู
ูุชูุณูู ุงูุฃุฑูุงู ูู ุจูู ุฃููุฑ ุฃุฎุฑู. ุฏุนูุง ูุทุจู ุงูุชุทุจูุน ุนูู ูุตูุต Whisper ูุฅุธูุงุฑ ููู ูููููุง
ุชุทุจูุนูุง:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

prediction = " He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind."
normalized_prediction = normalizer(prediction)

normalized_prediction
```
**ุงููุฎุฑุฌุงุช:**
```
' he tells us that at this festive season of the year with christmas and roast beef looming before us similarly is drawn from eating and its results occur most readily to the mind '
```
```
ุฑุงุฆุน! ูููููุง ุฃู ูุฑู ุฃู ุงููุต ูุฏ ุชู ุชุญูููู ุจุงููุงูู ุฅูู ุญุฑูู ุตุบูุฑุฉ ูุชู ุฅุฒุงูุฉ ุนูุงูุงุช ุงูุชุฑููู. ุฏุนูุง ุงูุขู ูุญุฏุฏ ุงููุต ุงููุฑุฌุนู
ุซู ูุญุณุจ ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุงููุนูุงุฑูุฉ ุจูู ุงููุฑุฌุน ูุงูุชูุจุค:

```python
reference = "HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAS AND ROAST BEEF LOOMING BEFORE US SIMILES DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND"
normalized_referece = normalizer(reference)

wer = wer_metric.compute(
    references=[normalized_referece], predictions=[normalized_prediction]
)
wer
```
**Output:**
```
0.0625
```

6.25% - ูุฐุง ูุง ูุชููุนู ุชูุฑูุจุงู ููููุฐุฌ Whisper ุงูุฃุณุงุณู ุนูู ูุฌููุนุฉ ุงูุชุญูู ูู LibriSpeech. ููุง ูุฑู ููุงุ
ููุฏ ุชูุจุฃูุง ุจูุต ุฅููุงุฆูุ ูููู ุงุณุชูุฏูุง ูู ุชุนุฒูุฒ WER ุงูุฐู ุญุตููุง ุนููู ูู ุฎูุงู ุชุทุจูุน ุงููุฑุฌุน ูุงูุชูุจุค
ูุจู ุญุณุงุจ WER.

ูุนุฏ ุงุฎุชูุงุฑ ููููุฉ ุชุทุจูุน ุงููุตูุต ูู ุงูููุงูุฉ ูู ูุง ุชุญุชุงุฌ ุฅููู. ููุตู ุจุงูุชุฏุฑูุจ ุนูู
ุงููุต ุงูุฅููุงุฆู ูุชูููู ุงููุต ุงููุนูุงุฑู ููุญุตูู ุนูู ุฃูุถู ูุง ูู ุงูุนุงูููู.

## ูุถุน ูู ุดูุก ูุนูุง

ุญุณููุง! ููุฏ ุบุทููุง ุซูุงุซุฉ ููุงุถูุน ุญุชู ุงูุขู ูู ูุฐู ุงููุญุฏุฉ: ุงูููุงุฐุฌ ุงูููุฏุฑุจุฉ ูุณุจููุงุ ูุงุฎุชูุงุฑ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุงูุชูููู.
ุฏุนููุง ูุณุชูุชุน ููุถุนูุง ูุนูุง ูู ูุซุงู ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ ๐ ุณูููู ุจุฅุนุฏุงุฏ ุฃููุณูุง ููุฌุฒุก ุงูุชุงูู ุญูู ุงูุถุจุท ุงูุฏููู ูู ุฎูุงู ุชูููู ูููุฐุฌ Whisper ุงูููุฏุฑุจ ูุณุจููุง ุนูู ูุฌููุนุฉ ุงุฎุชุจุงุฑ Dhivehi Common Voice 13. ุณูุณุชุฎุฏู
ุฑูู WER ุงูุฐู ูุญุตู ุนููู ูู _baseline_ ูุชุดุบูู ุงูุถุจุท ุงูุฏููู ูุฏููุงุ ุฃู ุฑูู ูุณุชูุฏู ุณูุญุงูู ุงูุชุบูุจ ุนููู ๐ฅ

ุฃููุงูุ ุณูููู ุจุชุญููู ูููุฐุฌ Whisper ุงูููุฏุฑุจ ูุณุจููุง ุจุงุณุชุฎุฏุงู ูุฆุฉ `pipeline()`. ุณุชููู ูุฐู ุงูุนูููุฉ ูุฃูููุฉ ููุบุงูุฉ ุงูุขู!
ุงูุดูุก ุงูุฌุฏูุฏ ุงููุญูุฏ ุงูุฐู ุณูููู ุจู ูู ุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (float16) ุฅุฐุง ูุงู ูุนูู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU) - ููุฐุง ุณูุฒูุฏ ูู ุณุฑุนุฉ
ุงูุงุณุชุฏูุงู ุจุชูููุฉ ุถุฆููุฉ ุฌุฏูุง ุนูู ุฏูุฉ WER.

```python
from transformers import pipeline
import torch

if torch.cuda.is_available():
    device = "cuda:0"
    torch_dtype = torch.float16
else:
    device = "cpu"
    torch_dtype = torch.float32

pipe = pipeline(
    "automatic-speech-recognition",
    model="openai/whisper-small",
    torch_dtype=torch_dtype,
    device=device,
)
```

ุจุนุฏ ุฐููุ ุณูููู ุจุชุญููู ุชูุณูู ุงุฎุชุจุงุฑ Dhivehi ูู Common Voice 13. ุณุชุชุฐูุฑ ูู ุงููุณู ุงูุณุงุจู ุฃู Common
Voice 13 ูู *gated*ุ ููุง ูุนูู ุฃูู ูุงู ุนูููุง ุงูููุงููุฉ ุนูู ุดุฑูุท ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุจู ุงูุญุตูู ุนูู ุญู ุงููุตูู ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ูููููุง ุงูุขู
ุฑุจุท ุญุณุงุจ Hugging Face ุงูุฎุงุต ุจูุง ุจุฏูุชุฑ ุงูููุงุญุธุงุช ุงูุฎุงุต ุจูุงุ ุจุญูุซ ูููู ูุฏููุง ุญู ุงููุตูู ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูู ุงูุฌูุงุฒ ุงูุฐู ูุณุชุฎุฏูู ุญุงูููุง.

ุฑุจุท ุฏูุชุฑ ุงูููุงุญุธุงุช ุจุงููุฑูุฒ ุณูู - ูู ูุง ูุชุทูุจู ุงูุฃูุฑ ูู ุฅุฏุฎุงู ุฑูุฒ ุงููุตุงุฏูุฉ ุงูุฎุงุต ุจู ุนูุฏ ุงููุทุงูุจุฉ.
ุงุจุญุซ ุนู ุฑูุฒ ูุตุงุฏูุฉ ุงููุฑูุฒ ุงูุฎุงุต ุจู [ููุง](https://huggingface.co/settings/tokens) ูุฃุฏุฎููุง ุนูุฏ ุงููุทุงูุจุฉ:

```python
from huggingface_hub import notebook_login

notebook_login()
```

ุฑุงุฆุน! ุจูุฌุฑุฏ ุฃู ูููุง ุจุฑุจุท ุฏูุชุฑ ุงูููุงุญุธุงุช ุจุญุณุงุจ Hugging Face ุงูุฎุงุต ุจูุงุ ูููููุง ุงููุชุงุจุนุฉ ุจุชูุฒูู ูุฌููุนุฉ ุจูุงูุงุช Common Voice
ุณูุณุชุบุฑู ูุฐุง ุจุถุน ุฏูุงุฆู ููุชูุฒูู ูุงูุชุญุถูุฑุ ุญูุซ ูุชู ุฌูุจ ุงูุจูุงูุงุช ูู Hugging Face Hub
ูุชุญุถูุฑูุง ุชููุงุฆููุง ุนูู ุฏูุชุฑ ุงูููุงุญุธุงุช ุงูุฎุงุต ุจู:

```python
from datasets import load_dataset

common_voice_test = load_dataset(
    "mozilla-foundation/common_voice_13_0", "dv", split="test"
)
```

<Tip>
    ุฅุฐุง ูุงุฌูุช ูุดููุฉ ูู ุงููุตุงุฏูุฉ ุนูุฏ ุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุชุ ุชุฃูุฏ ูู ุฃูู ูุฏ ูุจูุช ุดุฑูุท ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุจูุงูุงุช
    ุนูู Hugging Face Hub ูู ุฎูุงู ุงูุฑุงุจุท ุงูุชุงูู: https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0
</Tip>

ูููู ุฅุฌุฑุงุก ุงูุชูููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุงููุฉ ุจููุณ ุงูุทุฑููุฉ ุชูุฑูุจูุง ููุง ูู ุงูุญุงู ุจุงููุณุจุฉ ููุซุงู ูุงุญุฏ - ูู ูุง ุนูููุง ูุนูู ูู **loop**
ุนูู ูููุงุช ุงูุตูุช ุงููุฏุฎูุฉุ ุจุฏูุงู ูู ุงูุงุณุชุฏูุงู ุนูู ุนููุฉ ูุงุญุฏุฉ ููุท. ููููุงู ุจุฐููุ ูููู ุฃููุงู ุจุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุฅูู
`KeyDataset`. ูู ูุง ููุนูู ูู ุงุฎุชูุงุฑ ุนููุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุญุฏุฏุฉ ุงูุฐู ูุฑูุฏ ุฅุฑุณุงูู ุฅูู ุงููููุฐุฌ (ูู ุญุงูุชูุงุ ูุฐุง ูู
ุนููุฏ "audio"ุ ูุชุฌุงููุงู ุงูุจุงูู (ูุซู ุงููุตูุต ุงููุณุชูุฏูุฉุ ูุงูุชู ูุง ูุฑูุฏ ุงุณุชุฎุฏุงููุง ููุงุณุชุฏูุงู). ุซู ูููู ุจุงูุชููู ุนุจุฑ ูุฐู ุงููุฌููุนุงุช ุงููุญููุฉุ ูุฅุถุงูุฉ ูุฎุฑุฌุงุช ุงููููุฐุฌ ุฅูู ูุงุฆูุฉ ูุญูุธ ุงูุชูุจุคุงุช. ุณุชุณุชุบุฑู ุฎููุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ุญูุงูู ุฎูุณ ุฏูุงุฆู ุฅุฐุง ูุงูุช ุชุนูู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU) ุจูุตู ุงูุฏูุฉุ ูุชุตู ุฅูู 12 ุฌูุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ:

```python
from tqdm import tqdm
from transformers.pipelines.pt_utils import KeyDataset

all_predictions = []

# run streamed inference
for prediction in tqdm(
    pipe(
        KeyDataset(common_voice_test, "audio"),
        max_new_tokens=128,
        generate_kwargs={"task": "transcribe"},
        batch_size=32,
    ),
    total=len(common_voice_test),
):
    all_predictions.append(prediction["text"])
```

<Tip>
    ุฅุฐุง ูุงุฌูุช ูุดููุฉ ูู ุฐุงูุฑุฉ CUDA (OOM) ุนูุฏ ุชุดุบูู ุงูุฎููุฉ ุฃุนูุงูุ ูู ุจุชุฎููุถ ุญุฌู ุงูุฏููุนุฉ ุจุดูู ุชุฏุฑูุฌู ุจุนูุงูู 2 ุญุชู ุชุฌุฏ ุญุฌู ุฏูุนุฉ ููุงุณุจ ุฌูุงุฒู.
</Tip>

ูุฃุฎูุฑูุงุ ูููููุง ุญุณุงุจ ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER). ุฏุนูุง ูุญุณุจ ุฃููุงู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุงูุฅููุงุฆูุฉุ ุฃู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุจุฏูู ุฃู ูุนุงูุฌุฉ ูุงุญูุฉ:

```python
from evaluate import load

wer_metric = load("wer")

wer_ortho = 100 * wer_metric.compute(
    references=common_voice_test["sentence"], predictions=all_predictions
)
wer_ortho
```
**Output:**
```
167.29577268612022
```

ุญุณููุง... 167% ูุนูู ุจุดูู ุฃุณุงุณู ุฃู ุงููููุฐุฌ ุงูุฎุงุต ุจูุง ููุชุฌ ููุงูุฉ ๐ ูุง ุชูููุ ุณูููู ูุฏููุง ูู ุชุญุณูู ุฐูู ูู ุฎูุงู
ุงูุถุจุท ุงูุฏููู ูููููุฐุฌ ุนูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ Dhivehi!

ุจุนุฏ ุฐููุ ุณูููู ุจุชูููู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุงููุนูุงุฑูุฉุ ุฃู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ูุน ูุนุงูุฌุฉ ุงูุชุทุจูุน ุงููุงุญูุฉ. ูุฌุจ ุนูููุง ุชุตููุฉ ุงูุนููุงุช
ุงูุชู ุณุชููู ูุงุฑุบุฉ ุจุนุฏ ุงูุชุทุจูุนุ ูุฅูุง ูุฅู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช ูู ูุฑุฌุนูุง (N) ุณูููู ุตูุฑูุงุ ูุงูุฐู
ุณูุนุทู ุฎุทุฃ ูู ุงููุณูุฉ ุนูู ุงูุตูุฑ ูู ุญุณุงุจูุง:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

# compute normalised WER
all_predictions_norm = [normalizer(pred) for pred in all_predictions]
all_references_norm = [normalizer(label) for label in common_voice_test["sentence"]]

# filtering step to only evaluate the samples that correspond to non-zero references
all_predictions_norm = [
    all_predictions_norm[i]
    for i in range(len(all_predictions_norm))
    if len(all_references_norm[i]) > 0
]
all_references_norm = [
    all_references_norm[i]
    for i in range(len(all_references_norm))
    if len(all_references_norm[i]) > 0
]

wer = 100 * wer_metric.compute(
    references=all_references_norm, predictions=all_predictions_norm
)

wer
```
**Output:**
```
125.69809089960707
```

ูุฑุฉ ุฃุฎุฑูุ ูุฑู ุงูุงูุฎูุงุถ ุงููุจูุฑ ูู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุงูุฐู ูุญุตู ุนููู ูู ุฎูุงู ุชุทุจูุน ูุฑุงุฌุนูุง ูุชูุจุคุงุชูุง: ูุญูู ุงููููุฐุฌ ุงูุฃุณุงุณู
ูุณุจุฉ ุฎุทุฃ ูู ุงููููุงุช (WER) ุงุฎุชุจุงุฑูุฉ ุฅููุงุฆูุฉ ุชุจูุบ 168%ุ ูู ุญูู ุฃู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงููููุงุช (WER) ุงููุนูุงุฑูุฉ ุชุจูุบ 126%.

ุญุณููุง! ูุฐู ูู ุงูุฃุฑูุงู ุงูุชู ูุฑูุฏ ูุญุงููุฉ ุงูุชุบูุจ ุนูููุง ุนูุฏูุง ูููู ุจุถุจุท ุงููููุฐุฌ ุงูุฏูููุ ูู ุฃุฌู ุชุญุณูู ูููุฐุฌ Whisper
ููุชุนุฑู ุนูู ุงูููุงู ูู Dhivehi. ุชุงุจุน ุงููุฑุงุกุฉ ููุญุตูู ุนูู ูุซุงู ุนููู ููุถุจุท ุงูุฏููู ๐
