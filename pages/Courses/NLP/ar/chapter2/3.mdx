<FrameworkSwitchCourse {fw} />

# ุงูููุงุฐุฌ [[models]]

{#if fw === 'pt'}

<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter2/section3_pt.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter2/section3_pt.ipynb"},
]} />

{:else}

<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter2/section3_tf.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter2/section3_tf.ipynb"},
]} />

{/if}

{#if fw === 'pt'}
<Youtube id="AhChOFRegn4"/>
{:else}
<Youtube id="d3JVgghSOew"/>
{/if}

{#if fw === 'pt'}
ูู ูุฐุง ุงููุณู ุณูููู ูุธุฑุฉ ุนู ูุฑุจ ุนูู ุฅูุดุงุก ูุงุณุชุฎุฏุงู ูููุฐุฌ. ุณูุณุชุฎุฏู ูุฆุฉ `AutoModel`ุ ูุงูุชู ุชููู ูููุฏุฉ ุนูุฏูุง ุชุฑูุฏ ุฅูุดุงุก ุฃู ูููุฐุฌ ูู ููุทุฉ ุชูุชูุด.

ุฅู ูุฆุฉ `AutoModel` ูุฌููุน ูุฆุงุชูุง ุงููุฑุนูุฉ ูู ูู ุงููุงูุน ุฃุบููุฉ ุจุณูุทุฉ ููุฌููุนุฉ ูุชููุนุฉ ูู ุงูููุงุฐุฌ ุงููุชุงุญุฉ ูู ุงูููุชุจุฉ. ุฅููุง ุบูุงู ุฐูู ูุฃูู ููููู ุชุฎููู ุจููุฉ ุงููููุฐุฌ ุงูููุงุณุจุฉ ูููุทุฉ ุงูุชูุชูุด ุงูุฎุงุตุฉ ุจู ุชููุงุฆููุงุ ุซู ููุดุฆ ูููุฐุฌูุง ุจูุฐู ุงูุจููุฉ.

{:else}
ูู ูุฐุง ุงููุณู ุณูููู ูุธุฑุฉ ุนู ูุฑุจ ุนูู ุฅูุดุงุก ูุงุณุชุฎุฏุงู ูููุฐุฌ. ุณูุณุชุฎุฏู ูุฆุฉ `TFAutoModel`ุ ูุงูุชู ุชููู ูููุฏุฉ ุนูุฏูุง ุชุฑูุฏ ุฅูุดุงุก ุฃู ูููุฐุฌ ูู ููุทุฉ ุชูุชูุด.

ุฅู ูุฆุฉ `TFAutoModel` ูุฌููุน ูุฆุงุชูุง ุงููุฑุนูุฉ ูู ูู ุงููุงูุน ุฃุบููุฉ ุจุณูุทุฉ ููุฌููุนุฉ ูุชููุนุฉ ูู ุงูููุงุฐุฌ ุงููุชุงุญุฉ ูู ุงูููุชุจุฉ. ุฅููุง ุบูุงู ุฐูู ูุฃูู ููููู ุชุฎููู ุจููุฉ ุงููููุฐุฌ ุงูููุงุณุจุฉ ูููุทุฉ ุงูุชูุชูุด ุงูุฎุงุตุฉ ุจู ุชููุงุฆููุงุ ุซู ููุดุฆ ูููุฐุฌูุง ุจูุฐู ุงูุจููุฉ.

{/if}

ููุน ุฐููุ ุฅุฐุง ููุช ุชุนุฑู ููุน ุงููููุฐุฌ ุงูุฐู ุชุฑูุฏ ุงุณุชุฎุฏุงููุ ูููููู ุงุณุชุฎุฏุงู ุงููุฆุฉ ุงูุชู ุชุญุฏุฏ ุจููุชู ูุจุงุดุฑุฉู. ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุนูู ุฐูู ูุน ูููุฐุฌ BERT.

## ุฅูุดุงุก ูุญูู [[creating-a-transformer]]

ุฃูู ุดูุก ุณูุญุชุงุฌ ุฅูู ุงูููุงู ุจู ูุชููุฆุฉ ูููุฐุฌ BERT ูู ุชุญููู ูุงุฆู ุงูุชููุฆุฉ:

{#if fw === 'pt'}
```py
from transformers import BertConfig, BertModel

# ุจูุงุก ุงูุชููุฆุฉ
config = BertConfig()

# ุจูุงุก ุงููููุฐุฌ ูู ุงูุชููุฆุฉ
model = BertModel(config)
```
{:else}
```py
from transformers import BertConfig, TFBertModel

# ุจูุงุก ุงูุชููุฆุฉ
config = BertConfig()

# ุจูุงุก ุงููููุฐุฌ ูู ุงูุชููุฆุฉ
model = TFBertModel(config)
```
{/if}

ุชุญุชูู ุงูุชููุฆุฉ ุนูู ุงูุนุฏูุฏ ูู ุงูุฎุตุงุฆุต ุงูุชู ุชุณุชุฎุฏู ูุจูุงุก ุงููููุฐุฌ:

```py
print(config)
```

```python out
BertConfig {
  [...]
  "hidden_size": 768,
  "intermediate_size": 3072,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  [...]
}
```

ุนูู ุงูุฑุบู ูู ุฃูู ูู ุชุฑู ุจุนุฏ ูุง ุชูุนูู ูู ูุฐู ุงูุฎุตุงุฆุตุ ุฅูุง ุฃูู ูุฌุจ ุฃู ุชุนุฑู ุจุนุถูุง: ุชุญุฏุฏ ุฎุงุตูุฉ `hidden_size` ุญุฌู ูุชุฌู `hidden_states`ุ ูุชุญุฏุฏ ุฎุงุตูุฉ `num_hidden_layers` ุนุฏุฏ ุงูุทุจูุงุช ุงูุชู ููุชูููุง ูููุฐุฌ ุงููุญูู.

### ุทุฑู ุงูุชุญููู ุงููุฎุชููุฉ [[different-loading-methods]]

ูุชู ุฅูุดุงุก ูููุฐุฌ ูู ุงูุชููุฆุฉ ุงูุงูุชุฑุงุถูุฉ ููุชู ุชููุฆุชู ุจููู ุนุดูุงุฆูุฉ:

{#if fw === 'pt'}
```py
from transformers import BertConfig, BertModel

config = BertConfig()
model = BertModel(config)

# ุชู ุชููุฆุฉ ุงููููุฐุฌ ุจุดูู ุนุดูุงุฆู!
```
{:else}
```py
from transformers import BertConfig, TFBertModel

config = BertConfig()
model = TFBertModel(config)

# ุชู ุชููุฆุฉ ุงููููุฐุฌ ุจุดูู ุนุดูุงุฆู!
```
{/if}

ูููู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ูู ูุฐู ุงูุญุงูุฉุ ููููู ุณูุฎุฑุฌ ูุชุงุฆุฌ ุบูุฑ ูููููุฉุ ููู ูุญุชุงุฌ ุฅูู ุงูุชุฏุฑูุจ ุฃููุงู. ูููููุง ุชุฏุฑูุจ ุงููููุฐุฌ ูู ุงูุตูุฑ ุนูู ุงููููุฉ ุงููุทุฑูุญุฉุ ูููู ููุง ุฑุฃูุช ูู [ุงููุตู 1](/course/chapter1)ุ ูุฅู ูุฐุง ุณูุชุทูุจ ููุชูุง ุทูููุงู ููููุฉ ูุจูุฑุฉ ูู ุงูุจูุงูุงุชุ ูุณูููู ูู ุชุฃุซูุฑ ุจูุฆู ุบูุฑ ูุงุจู ููุชุฌุงูู. ูุชุฌูุจ ุงูุฌููุฏ ุบูุฑ ุงูุถุฑูุฑูุฉ ูุงูููุฑุฑุฉุ ูู ุงูุถุฑูุฑู ุงููุฏุฑุฉ ุนูู ูุดุงุฑูุฉ ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ุงูุชู ุชู ุชุฏุฑูุจูุง ุจุงููุนู.

ุฅู ุชุญููู ูููุฐุฌ ูุญูู ุชู ุชุฏุฑูุจู ุจุงููุนู ุฃูุฑ ุจุณูุท - ูููููุง ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `from_pretrained()` :

{#if fw === 'pt'}
```py
from transformers import BertModel

model = BertModel.from_pretrained("bert-base-cased")
```

ููุง ุฑุฃูุช ุณุงุจููุงุ ูููููุง ุงุณุชุจุฏุงู `BertModel` ุจูุฆุฉ `AutoModel` ุงูููุงูุฆุฉ. ุณูููู ุจุฐูู ูู ุงูุขู ูุตุงุนุฏูุง ูุฃู ูุฐุง ููุชุฌ ุนูู ููุฏ ุบูุฑ ูุฑุชุจุท ุจููุทุฉ ุงูุชูุชูุดุ ุฅุฐุง ูุงู ููุฏู ูุนูู ูููุทุฉ ุชูุชูุด ูุงุญุฏุฉุ ููุฌุจ ุฃู ูุนูู ุจุณูุงุณุฉ ูุน ููุทุฉ ุชูุชูุด ุฃุฎุฑู. ููุทุจู ูุฐุง ุญุชู ุฅุฐุง ูุงูุช ุงูุจููุฉ ูุฎุชููุฉุ ุทุงููุง ุชู ุชุฏุฑูุจ ููุทุฉ ุงูุชูุชูุด ุนูู ูููุฉ ููุงุซูุฉ (ุนูู ุณุจูู ุงููุซุงูุ ูููุฉ ุชุญููู ุงููุดุงุนุฑ).

{:else}
```py
from transformers import TFBertModel

model = TFBertModel.from_pretrained("bert-base-cased")
```

ููุง ุฑุฃูุช ุณุงุจููุงุ ูููููุง ุงุณุชุจุฏุงู `TFBertModel` ุจูุฆุฉ `TFAutoModel` ุงูููุงูุฆุฉ. ุณูููู ุจุฐูู ูู ุงูุขู ูุตุงุนุฏูุง ูุฃู ูุฐุง ููุชุฌ ุนูู ููุฏ ุบูุฑ ูุฑุชุจุท ุจููุทุฉ ุงูุชูุชูุดุ ุฅุฐุง ูุงู ููุฏู ูุนูู ูููุทุฉ ุชูุชูุด ูุงุญุฏุฉุ ููุฌุจ ุฃู ูุนูู ุจุณูุงุณุฉ ูุน ููุทุฉ ุชูุชูุด ุฃุฎุฑู. ููุทุจู ูุฐุง ุญุชู ุฅุฐุง ูุงูุช ุงูุจููุฉ ูุฎุชููุฉุ ุทุงููุง ุชู ุชุฏุฑูุจ ููุทุฉ ุงูุชูุชูุด ุนูู ูููุฉ ููุงุซูุฉ (ุนูู ุณุจูู ุงููุซุงูุ ูููุฉ ุชุญููู ุงููุดุงุนุฑ).

{/if}

ูู ุนููุฉ ุงูููุฏ ุฃุนูุงูุ ูู ูุณุชุฎุฏู `BertConfig`ุ ูุจุฏูุงู ูู ุฐูู ูููุง ุจุชุญููู ูููุฐุฌ ูุฏุฑุจ ูุณุจููุง ุนุจุฑ ูุญุฏุฏ `bert-base-cased`. ูุฐู ูู ููุทุฉ ุชูุชูุด ุงููููุฐุฌ ุงูุชู ูุงู ุจุชุฏุฑูุจูุง ูุคููู BERT ุฃููุณููุ ููููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูููุง ูู [ุจุทุงูุฉ ุงููููุฐุฌ](https://huggingface.co/bert-base-cased).

ุชู ุชููุฆุฉ ูุฐุง ุงููููุฐุฌ ุงูุขู ุจุฌููุน ุฃูุฒุงู ููุทุฉ ุงูุชูุชูุด. ูููู ุงุณุชุฎุฏุงูู ูุจุงุดุฑุฉ ููุชูุจุค ุจุงููููุฉ ุงูุชู ุชู ุชุฏุฑูุจู ุนูููุงุ ููููู ุฃูุถูุง ุถุจุทู ุจุฏูุฉ ููููุฉ ุฌุฏูุฏุฉ. ูู ุฎูุงู ุงูุชุฏุฑูุจ ุจุงุณุชุฎุฏุงู ุงูุฃูุฒุงู ุงููุฏุฑุจุฉ ูุณุจููุง ุจุฏูุงู ูู ุงูุชุฏุฑูุจ ูู ุงูุตูุฑุ ูููููุง ุชุญููู ูุชุงุฆุฌ ุฌูุฏุฉ ุจุณุฑุนุฉ.

ุชู ุชูุฒูู ุงูุฃูุฒุงู ูุชุฎุฒูููุง ูุคูุชูุง (ูุฐูู ูู ุชููู ุงูููุงููุงุช ุงููุณุชูุจููุฉ ูุทุฑููุฉ `from_pretrained()` ุจุฅุนุงุฏุฉ ุชูุฒูููุง) ูู ูุฌูุฏ ุงูุชุฎุฒูู ุงููุคูุชุ ูุงูุฐู ูููู ุงูุชุฑุงุถููุง *~/.cache/huggingface/transformers*. ููููู ุชุฎุตูุต ูุฌูุฏ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฎุงุต ุจู ุนู ุทุฑูู ุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ `HF_HOME`.

ูููู ุฃู ูููู ุงููุญุฏุฏ ุงููุณุชุฎุฏู ูุชุญููู ุงููููุฐุฌ ูู ูุญุฏุฏ ุฃู ูููุฐุฌ ุนูู Model Hubุ ุทุงููุง ุฃูู ูุชูุงูู ูุน ุจููุฉ BERT. ูููู ุงูุนุซูุฑ ุนูู ุงููุงุฆูุฉ ุงููุงููุฉ ูููุงุท ุชูุชูุด BERT ุงููุชุงุญุฉ [ููุง](https://huggingface.co/models?filter=bert).

### ุทุฑู ุงูุญูุธ [[saving-methods]]

ุฅู ุญูุธ ุงููููุฐุฌ ุณูู ูุซู ุชุญูููู - ูุณุชุฎุฏู ุทุฑููุฉ `save_pretrained()`ุ ูุงูุชู ุชููู ููุงุซูุฉ ูุทุฑููุฉ `from_pretrained()` :

```py
model.save_pretrained("directory_on_my_computer")
```

ูุฐุง ูุญูุธ ููููู ุนูู ุงููุฑุต ุงูุฎุงุต ุจู:

{#if fw === 'pt'}
```
ls directory_on_my_computer

config.json pytorch_model.bin
```
{:else}
```
ls directory_on_my_computer

config.json tf_model.h5
```
{/if}

ุฅุฐุง ูุธุฑุช ุฅูู ููู *config.json*ุ ูุณุชุชุนุฑู ุนูู ุงูุฎุตุงุฆุต ุงูุถุฑูุฑูุฉ ูุจูุงุก ุจููุฉ ุงููููุฐุฌ. ูุญุชูู ูุฐุง ุงูููู ุฃูุถูุง ุนูู ุจุนุถ ุงูุจูุงูุงุช ุงููุตููุฉุ ูุซู ููุงู ูุดุฃุฉ ููุทุฉ ุงูุชูุชูุด ูุฅุตุฏุงุฑ ๐ค Transformers ุงูุฐู ููุช ุชุณุชุฎุฏูู ุนูุฏ ุขุฎุฑ ูุฑุฉ ููุช ุจุญูุธ ููุทุฉ ุงูุชูุชูุด.

{#if fw === 'pt'}
ุฅู ููู *pytorch_model.bin* ูุนุฑูู ุจุงุณู *ูุงููุณ ุงูุญุงูุฉ*ุ ููู ูุญุชูู ุนูู ุฌููุน ุฃูุฒุงู ุงููููุฐุฌ ุงูุฎุงุต ุจู. ูุณูุฑ ุงููููุงู ุฌูุจูุง ุฅูู ุฌูุจุ ุงูุชููุฆุฉ ุถุฑูุฑูุฉ ููุนุฑูุฉ ุจููุฉ ุงููููุฐุฌ ุงูุฎุงุต ุจูุ ูู ุญูู ุฃู ุฃูุฒุงู ุงููููุฐุฌ ูู ูุนุงููุงุช ุงููููุฐุฌ ุงูุฎุงุต ุจู.

{:else}
ุฅู ููู *tf_model.h5* ูุนุฑูู ุจุงุณู *ูุงููุณ ุงูุญุงูุฉ*ุ ููู ูุญุชูู ุนูู ุฌููุน ุฃูุฒุงู ุงููููุฐุฌ ุงูุฎุงุต ุจู. ูุณูุฑ ุงููููุงู ุฌูุจูุง ุฅูู ุฌูุจุ ุงูุชููุฆุฉ ุถุฑูุฑูุฉ ููุนุฑูุฉ ุจููุฉ ุงููููุฐุฌ ุงูุฎุงุต ุจูุ ูู ุญูู ุฃู ุฃูุฒุงู ุงููููุฐุฌ ูู ูุนุงููุงุช ุงููููุฐุฌ ุงูุฎุงุต ุจู.

{/if}

## ุงุณุชุฎุฏุงู ูููุฐุฌ ุงููุญูู ููุชูุจุค [[using-a-transformer-model-for-inference]]

ุงูุขู ุจุนุฏ ุฃู ุชุนุฑูุช ุนูู ููููุฉ ุชุญููู ูุญูุธ ูููุฐุฌุ ุฏุนูุง ูุญุงูู ุงุณุชุฎุฏุงูู ูุชูุฏูู ุจุนุถ ุงูุชูุจุคุงุช. ูููู ูููุงุฐุฌ ุงููุญูู ูุนุงูุฌุฉ ุงูุฃุฑูุงู ููุท - ุงูุฃุฑูุงู ุงูุชู ูููุฏูุง ุงููุญูู. ูููู ูุจู ููุงูุดุฉ ุงููุญููุงุชุ ุฏุนูุง ูุณุชูุดู ุงููุฏุฎูุงุช ุงูุชู ููุจููุง ุงููููุฐุฌ.

ูููู ูููุญููุงุช ุงูุชุนุงูู ูุน ุชุญููู ุงููุฏุฎูุงุช ุฅูู ุชูุณูุฑุงุช ุงูุฅุทุงุฑ ุงูููุงุณุจุ ูููู ููุณุงุนุฏุชู ุนูู ููู ูุง ูุญุฏุซุ ุณูููู ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ูุง ูุฌุจ ุงูููุงู ุจู ูุจู ุฅุฑุณุงู ุงููุฏุฎูุงุช ุฅูู ุงููููุฐุฌ.

ูููุชุฑุถ ุฃู ูุฏููุง ุจุนุถ ุงูุชุณูุณูุงุช:

```py
sequences = ["Hello!", "Cool.", "Nice!"]
```
ูุญูู ุงููุญูู ุงููุตู ูุฐู ุงููููุงุช ุฅูู ููุฑุณ ุงููุงููุณ ูุงูุฐู ูุทูู ุนููู ุนุงุฏุฉู *ูุฏุฎูุงุช ุงูุฅุฏุฎุงู*. ูู ุณูุณูุฉ ุงูุขู ุนุจุงุฑุฉ ุนู ูุงุฆูุฉ ูู ุงูุฃุฑูุงู! ูุงููุงุชุฌ ูู:

```py no-format
encoded_sequences = [
    [101, 7592, 999, 102],
    [101, 4658, 1012, 102],
    [101, 3835, 999, 102],
]
```

ูุฐู ูุงุฆูุฉ ูู ุงูุณูุงุณู ุงููุดูุฑุฉ: ูุงุฆูุฉ ูู ุงูููุงุฆู. ุชูุจู ุงููุตูููุงุช ููุท ุงูุฃุดูุงู ุงููุณุชุทููุฉ (ููุฑ ูู ุงููุตูููุงุช). ูุฐู "ุงููุตูููุฉ" ุจุงููุนู ุฐุงุช ุดูู ูุณุชุทููุ ูุฐุง ูุฅู ุชุญููููุง ุฅูู ูุตูููุฉ ุณูู:

{#if fw === 'pt'}
```py
import torch

model_inputs = torch.tensor(encoded_sequences)
```
{:else}
```py
import tensorflow as tf

model_inputs = tf.constant(encoded_sequences)
```
{/if}

### ุงุณุชุฎุฏุงู ุงููุตูููุงุช ููุฏุฎูุงุช ูููููุฐุฌ [[using-the-tensors-as-inputs-to-the-model]]

ุงุณุชุฎุฏุงู ุงููุตูููุงุช ูุน ุงููููุฐุฌ ุจุณูุท ููุบุงูุฉ โ ูุญู ููุท ูุณุชุฏุนู ุงููููุฐุฌ ูุน ุงููุฏุฎูุงุช:

```py
output = model(model_inputs)
```

ุจูููุง ููุจู ุงููููุฐุฌ ุงูุนุฏูุฏ ูู ุงูุญุฌุฌ ุงููุฎุชููุฉุ ุฅูุง ุฃู ูุฏุฎูุงุช ุงูุฅุฏุฎุงู ููุท ูู ุงูุถุฑูุฑูุฉ. ุณูุดุฑุญ ูุง ุชูุนูู ุงูุญุฌุฌ ุงูุฃุฎุฑู ููุชู ุชููู ูุทููุจุฉ ูุงุญููุงุ
ููููุง ูุญุชุงุฌ ุฃููุงู ุฅูู ุฅููุงุก ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงููุญููุงุช ุงููุตูุฉ ุงูุชู ุชุจูู ุงููุฏุฎูุงุช ุงูุชู ูููู ููููุฐุฌ ุงููุญูู ููููุง.