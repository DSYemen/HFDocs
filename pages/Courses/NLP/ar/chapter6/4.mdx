# ุงูุชุทุจูุน ูุงูุชูููุฏ ููุชุฌุฒูุก {}[[normalization-and-pre-tokenization]]

<CourseFloatingBanner chapter={6}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter6/section4.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter6/section4.ipynb"},
]} />

ูุจู ุฃู ูุชุนูู ุฃูุซุฑ ูู ุฎูุงุฑุฒููุงุช ุงูุชุฌุฒูุก ุงูุซูุงุซุฉ ุงูุฃูุซุฑ ุดููุนูุง ุงููุณุชุฎุฏูุฉ ูุน ููุงุฐุฌ ุงููุญูู (ุงูุชุฑููุฒ ุซูุงุฆู ุงูุจุงูุช [BPE]ุ ูWordPieceุ ูUnigram)ุ ุณูููู ุฃููุงู ูุธุฑุฉ ุนูู ูุง ูุจู ุงููุนุงูุฌุฉ ุงูุชู ูุทุจููุง ูู ูุฌุฒุฆ ุนูู ุงููุต. ูููุง ููู ูุธุฑุฉ ุนุงูุฉ ุนูู ุฎุทูุงุช ุฎุท ุฃูุงุจูุจ ุงูุชุฌุฒูุก:

<div class="flex justify-center">
<img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter6/tokenization_pipeline.svg" alt="ุฎุท ุฃูุงุจูุจ ุงูุชุฌุฒูุก.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter6/tokenization_pipeline-dark.svg" alt="ุฎุท ุฃูุงุจูุจ ุงูุชุฌุฒูุก.">
</div>

ูุจู ุชูุณูู ุงููุต ุฅูู ุฑููุฒ ูุฑุนูุฉ (ููููุง ููููุฐุฌู)ุ ูููู ุงููุฌุฒุฆ ุจุฎุทูุชูู: _ุงูุชุทุจูุน_ ู_ุงูุชูููุฏ ููุชุฌุฒูุก_.

## ุงูุชุทุจูุน {}[[normalization]]

<Youtube id="4IIC2jI9CaU"/>

ุชุชุถูู ุฎุทูุฉ ุงูุชุทุจูุน ุจุนุถ ุงูุชูุธูู ุงูุนุงูุ ูุซู ุฅุฒุงูุฉ ุงููุณุงูุงุช ุบูุฑ ุงูุถุฑูุฑูุฉุ ูุงูุชุญููู ุฅูู ุฃุญุฑู ุตุบูุฑุฉุ ู/ุฃู ุฅุฒุงูุฉ ุงูุชุดููู. ุฅุฐุง ููุช ุนูู ุฏุฑุงูุฉ ุจู [ุชุทุจูุน Unicode](http://www.unicode.org/reports/tr15/) (ูุซู NFC ุฃู NFKC)ุ ููุฐุง ุฃูุถูุง ุดูุก ูุฏ ูุทุจูู ุงููุฌุฒุฆ.

ูุฏู ๐ค Transformers `tokenizer` ุณูุฉ ุชุณูู `backend_tokenizer` ุงูุชู ุชููุฑ ุงููุตูู ุฅูู ุงููุฌุฒุฆ ุงูุฃุณุงุณู ูู ููุชุจุฉ ๐ค Tokenizers:

```py
from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("bert-base-uncased")
print(type(tokenizer.backend_tokenizer))
```

```python out
<class 'tokenizers.Tokenizer'>
```

ูุฏู ุณูุฉ `normalizer` ูููุงุฆู `tokenizer` ุทุฑููุฉ `normalize_str()` ุงูุชู ูููููุง ุงุณุชุฎุฏุงููุง ููุนุฑูุฉ ููููุฉ ุฅุฌุฑุงุก ุงูุชุทุจูุน:

```py
print(tokenizer.backend_tokenizer.normalizer.normalize_str("Hรฉllรฒ hรดw are รผ?"))
```

```python out
'hello how are u?'
```

ูู ูุฐุง ุงููุซุงูุ ูุธุฑูุง ูุฃููุง ุงุฎุชุฑูุง ููุทุฉ ุงูุชุญูู `bert-base-uncased`ุ ููุฏ ุทุจู ุงูุชุทุจูุน ุงูุชุญููู ุฅูู ุฃุญุฑู ุตุบูุฑุฉ ูุฃุฒุงู ุงูุชุดููู.

<Tip>

โ๏ธ **ุฌุฑุจู!** ูู ุจุชุญููู ูุฌุฒุฆ ูู ููุทุฉ ุงูุชุญูู `bert-base-cased` ููุฑุฑ ููุณ ุงููุซุงู ุฅููู. ูุง ูู ุงูุงุฎุชูุงูุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ููููู ููุงุญุธุชูุง ุจูู ุงูุฅุตุฏุงุฑุงุช ุงููุทุจูุฉ ูุบูุฑ ุงููุทุจูุฉ ูู ุงููุฌุฒุฆุ

</Tip>

## ุงูุชูููุฏ ููุชุฌุฒูุก {}[[pre-tokenization]]

<Youtube id="grlLV8AIXug"/>

ููุง ุณูุฑู ูู ุงูุฃูุณุงู ุงูุชุงููุฉุ ูุง ูููู ุชุฏุฑูุจ ุงููุฌุฒุฆ ุนูู ุงููุต ุงูุฎุงู ูุญุฏู. ุจุฏูุงู ูู ุฐููุ ูุญุชุงุฌ ุฃููุงู ุฅูู ุชูุณูู ุงููุตูุต ุฅูู ููุงูุงุช ุตุบูุฑุฉุ ูุซู ุงููููุงุช. ูููุง ูุฃุชู ุฏูุฑ ุฎุทูุฉ ุงูุชูููุฏ ููุชุฌุฒูุก. ููุง ุฑุฃููุง ูู [ุงููุตู 2](/course/chapter2)ุ ูููู ููุฌุฒุฆ ูุงุฆู ุนูู ุงููููุงุช ุจุจุณุงุทุฉ ุชูุณูู ูุต ุฎุงู ุฅูู ูููุงุช ุนูู ุงููุณุงูุงุช ูุงูููุงุตู. ุณุชููู ุชูู ุงููููุงุช ูู ุญุฏูุฏ ุงูุฑููุฒ ุงููุฑุนูุฉ ุงูุชู ูููู ูููุฌุฒุฆ ุชุนูููุง ุฃุซูุงุก ุชุฏุฑูุจู.

ูุฑุคูุฉ ููู ูููู ูุฌุฒุฆ ุณุฑูุน ุจุฃุฏุงุก ุงูุชูููุฏ ููุชุฌุฒูุกุ ูููููุง ุงุณุชุฎุฏุงู ุทุฑููุฉ `pre_tokenize_str()` ูุณูุฉ `pre_tokenizer` ูููุงุฆู `tokenizer`:

```py
tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str("Hello, how are  you?")
```

```python out
[('Hello', (0, 5)), (',', (5, 6)), ('how', (7, 10)), ('are', (11, 14)), ('you', (16, 19)), ('?', (19, 20))]
```

ูุงุญุธ ููู ูุญุชูุธ ุงููุฌุฒุฆ ุจุงููุนู ุจุชุชุจุน ุงูุฅุฒุงุญุงุชุ ููู ูุง ููููู ูู ุชุฒููุฏูุง ุจุฎุฑูุทุฉ ุงูุฅุฒุงุญุฉ ุงูุชู ุงุณุชุฎุฏููุงูุง ูู ุงููุณู ุงูุณุงุจู. ููุง ูุชุฌุงูู ุงููุฌุฒุฆ ุงููุณุงูุชูู ููุณุชุจุฏูููุง ุจูุงุญุฏุฉ ููุทุ ูููู ุงูุฅุฒุงุญุฉ ุชููุฒ ุจูู `are` ู`you` ููุฑุงุนุงุฉ ุฐูู.

ูุธุฑูุง ูุฃููุง ูุณุชุฎุฏู ูุฌุฒุฆ BERTุ ูุฅู ุงูุชูููุฏ ููุชุฌุฒูุก ููุทูู ุนูู ุงูุชูุณูู ุนูู ุงููุณุงูุงุช ูุงูููุงุตู. ูููู ููุฌุฒุฆุงุช ุฃุฎุฑู ุฃู ูููู ูุฏููุง ููุงุนุฏ ูุฎุชููุฉ ููุฐู ุงูุฎุทูุฉ. ุนูู ุณุจูู ุงููุซุงูุ ุฅุฐุง ุงุณุชุฎุฏููุง ูุฌุฒุฆ GPT-2:

```py
tokenizer = AutoTokenizer.from_pretrained("gpt2")
tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str("Hello, how are  you?")
```

ุณููุณู ุนูู ุงููุณุงูุงุช ูุงูููุงุตู ุฃูุถูุงุ ููููู ุณูุญุชูุธ ุจุงููุณุงูุงุช ููุณุชุจุฏููุง ุจุฑูุฒ `ฤ`ุ ููุง ููููู ูู ุงุณุชุนุงุฏุฉ ุงููุณุงูุงุช ุงูุฃุตููุฉ ุฅุฐุง ูููุง ุจูู ุฑููุฒ ุงูุฑููุฒ:

```python out
[('Hello', (0, 5)), (',', (5, 6)), ('ฤhow', (6, 10)), ('ฤare', (10, 14)), ('ฤ', (14, 15)), ('ฤyou', (15, 19)),
 ('?', (19, 20))]
```

ูุงุญุธ ุฃูุถูุง ุฃู ูุฐุง ุงููุฌุฒุฆุ ุนูู ุนูุณ ูุฌุฒุฆ BERTุ ูุง ูุชุฌุงูู ุงููุณุงูุชูู ุงููุฒุฏูุฌุชูู.

ููุซุงู ุฃุฎูุฑุ ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ูุฌุฒุฆ T5ุ ูุงูุฐู ูุนุชูุฏ ุนูู ุฎูุงุฑุฒููุฉ SentencePiece:

```py
tokenizer = AutoTokenizer.from_pretrained("t5-small")
tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str("Hello, how are  you?")
```

```python out
[('โHello,', (0, 6)), ('โhow', (7, 10)), ('โare', (11, 14)), ('โyou?', (16, 20))]
```

ูุซู ูุฌุฒุฆ GPT-2ุ ูุญุชูุธ ูุฐุง ุงููุฌุฒุฆ ุจุงููุณุงูุงุช ููุณุชุจุฏููุง ุจุฑูุฒ ูุญุฏุฏ (`_`)ุ ูููู ูุฌุฒุฆ T5 ููุณู ููุท ุนูู ุงููุณุงูุงุชุ ูููุณ ุงูููุงุตู. ูุงุญุธ ุฃูุถูุง ุฃูู ุฃุถุงู ูุณุงูุฉ ุงูุชุฑุงุถูุฉ ูู ุจุฏุงูุฉ ุงูุฌููุฉ (ูุจู `Hello`) ูุชุฌุงูู ุงููุณุงูุฉ ุงููุฒุฏูุฌุฉ ุจูู `are` ู`you`.

ุงูุขู ุจุนุฏ ุฃู ุฑุฃููุง ููู ุชููู ุจุนุถ ุงููุฌุฒุฆูุงุช ุงููุฎุชููุฉ ุจูุนุงูุฌุฉ ุงููุตุ ูููููุง ุงูุจุฏุก ูู ุงุณุชูุดุงู ุงูุฎูุงุฑุฒููุงุช ุงูุฃุณุงุณูุฉ ููุณูุง. ุณูุจุฏุฃ ุจูุธุฑุฉ ุณุฑูุนุฉ ุนูู ุฎูุงุฑุฒููุฉ SentencePiece ูุงุณุนุฉ ุงูุชุทุจููุ ุซูุ ุนูู ูุฏุงุฑ ุงูุฃูุณุงู ุงูุซูุงุซุฉ ุงูุชุงููุฉุ ุณููุญุต ููููุฉ ุนูู ุงูุฎูุงุฑุฒููุงุช ุงูุซูุงุซ ุงูุฑุฆูุณูุฉ ุงููุณุชุฎุฏูุฉ ููุชุฌุฒูุก ุงููุฑุนู ูููููุงุช.

## SentencePiece {}[[sentencepiece]]

[SentencePiece](https://github.com/google/sentencepiece) ูู ุฎูุงุฑุฒููุฉ ุชุฌุฒูุก ููุนุงูุฌุฉ ุงููุต ูุจู ุงููุนุงูุฌุฉ ุงูุชู ููููู ุงุณุชุฎุฏุงููุง ูุน ุฃู ูู ุงูููุงุฐุฌ ุงูุชู ุณูุฑุงูุง ูู ุงูุฃูุณุงู ุงูุซูุงุซุฉ ุงูุชุงููุฉ. ุชุนุชุจุฑ ุงููุต ูุชุณูุณู ูู ุฃุญุฑู Unicodeุ ูุชุณุชุจุฏู ุงููุณุงูุงุช ุจุฑูุฒ ุฎุงุตุ `โ`. ุนูุฏ ุงุณุชุฎุฏุงูู ุจุงูุงูุชุฑุงู ูุน ุฎูุงุฑุฒููุฉ Unigram (ุงูุธุฑ [ุงููุณู 7](/course/chapter7/7))ุ ูุฅูู ูุง ูุชุทูุจ ุญุชู ุฎุทูุฉ ุงูุชูููุฏ ููุชุฌุฒูุกุ ููู ุฃูุฑ ูููุฏ ููุบุงูุฉ ููุบุงุช ุงูุชู ูุง ุชุณุชุฎุฏู ุญุฑู ุงููุณุงูุฉ (ูุซู ุงูุตูููุฉ ุฃู ุงููุงุจุงููุฉ).

ุชุชูุซู ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ุงูุฃุฎุฑู ูู SentencePiece ูู *ุงูุชุฌุฒูุก ุงููุงุจู ููุนูุณ*: ูุธุฑูุง ูุนุฏู ูุฌูุฏ ูุนุงููุฉ ุฎุงุตุฉ ูููุณุงูุงุชุ ูุชู ูู ุฑููุฒ ุงูุฑููุฒ ุจุจุณุงุทุฉ ุนู ุทุฑูู ุฏูุฌูุง ูุงุณุชุจุฏุงู ุงูุฑููุฒ `_` ุจุงููุณุงูุงุช - ููุฐุง ูุคุฏู ุฅูู ุงููุต ุงููุทุจู. ููุง ุฑุฃููุง ุณุงุจููุงุ ูุฒูู ูุฌุฒุฆ BERT ุงููุณุงูุงุช ุงููุชูุฑุฑุฉุ ูุฐุง ูุฅู ุชุฌุฒูุฆู ุบูุฑ ูุงุจู ููุนูุณ.

## ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุฎูุงุฑุฒููุฉ {}[[algorithm-overview]]

ูู ุงูุฃูุณุงู ุงูุชุงููุฉุ ุณูุบูุต ูู ุฎูุงุฑุฒููุงุช ุงูุชุฌุฒูุก ุงููุฑุนู ูููููุงุช ุงูุซูุงุซุฉ ุงูุฑุฆูุณูุฉ: BPE (ุงูุฐู ูุณุชุฎุฏูู GPT-2 ูุบูุฑู)ุ ูWordPiece (ุงูุฐู ูุณุชุฎุฏูู BERT ุนูู ุณุจูู ุงููุซุงู)ุ ูUnigram (ุงูุฐู ูุณุชุฎุฏูู T5 ูุบูุฑู). ูุจู ุฃู ูุจุฏุฃุ ุฅููู ูุธุฑุฉ ุนุงูุฉ ุณุฑูุนุฉ ุนูู ููููุฉ ุนูู ูู ูููุง. ูุง ุชุชุฑุฏุฏ ูู ุงูุนูุฏุฉ ุฅูู ูุฐุง ุงูุฌุฏูู ุจุนุฏ ูุฑุงุกุฉ ูู ูู ุงูุฃูุณุงู ุงูุชุงููุฉ ุฅุฐุง ูู ููู ูุงุถุญูุง ุจุงููุณุจุฉ ูู ุจุนุฏ.


ุงููููุฐุฌ | BPE | WordPiece | Unigram
:----:|:---:|:---------:|:------:
ุงูุชุฏุฑูุจ | ูุจุฏุฃ ูู ููุฑุฏุงุช ุตุบูุฑุฉ ููุชุนูู ููุงุนุฏ ุฏูุฌ ุงูุฑููุฒ | ูุจุฏุฃ ูู ููุฑุฏุงุช ุตุบูุฑุฉ ููุชุนูู ููุงุนุฏ ุฏูุฌ ุงูุฑููุฒ | ูุจุฏุฃ ูู ููุฑุฏุงุช ูุจูุฑุฉ ููุชุนูู ููุงุนุฏ ุฅุฒุงูุฉ ุงูุฑููุฒ
ุฎุทูุฉ ุงูุชุฏุฑูุจ | ูุฏูุฌ ุงูุฑููุฒ ุงูููุงุจูุฉ ูุฃูุซุฑ ุงูุฃุฒูุงุฌ ุดููุนูุง | ูุฏูุฌ ุงูุฑููุฒ ุงูููุงุจูุฉ ููุฒูุฌ ุฐู ุฃูุถู ูุชูุฌุฉ ุจูุงุกู ุนูู ุชูุฑุงุฑ ุงูุฒูุฌุ ูุน ุฅุนุทุงุก ุงูุฃููููุฉ ููุฃุฒูุงุฌ ุงูุชู ูููู ูููุง ูู ุฑูุฒ ูุฑุฏู ุฃูู ุชูุฑุงุฑูุง | ูุฒูู ุฌููุน ุงูุฑููุฒ ูู ุงูููุฑุฏุงุช ุงูุชู ุณุชููู ูู ุงูุฎุณุงุฑุฉ ุงููุญุณูุจุฉ ุนูู ูุงูู ุงููุฌููุนุฉ
ูุชุนูู | ููุงุนุฏ ุงูุฏูุฌ ูููุฑุฏุงุช | ููุฑุฏุงุช ููุท | ููุฑุฏุงุช ูุน ูุชูุฌุฉ ููู ุฑูุฒ
ุงูุชุฑููุฒ | ููุณู ุงููููุฉ ุฅูู ุฃุญุฑู ููุทุจู ุนูููุงุช ุงูุฏูุฌ ุงูุชู ุชู ุชุนูููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ | ูุฌุฏ ุฃุทูู ูููุฉ ูุฑุนูุฉ ุจุฏุกูุง ูู ุงูุจุฏุงูุฉ ูุงูุชู ุชููู ูู ุงูููุฑุฏุงุชุ ุซู ููุนู ุงูุดูุก ููุณู ูุจููุฉ ุงููููุฉ | ูุฌุฏ ุงูุชูุณูู ุงูุฃูุซุฑ ุงุญุชูุงููุง ุฅูู ุฑููุฒุ ุจุงุณุชุฎุฏุงู ุงููุชุงุฆุฌ ุงูุชู ุชู ุชุนูููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ

ุงูุขู ุฏุนูุง ูุบูุต ูู BPE!