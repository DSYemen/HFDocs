# ููุช ุงูุชูุทูุน ูุงูุชูุณูู

<CourseFloatingBanner chapter={5}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter5/section3.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter5/section3.ipynb"},
]} />

ูุนุธู ุงูููุชุ ูู ุชููู ุงูุจูุงูุงุช ุงูุชู ุชุนูู ุนูููุง ุฌุงูุฒุฉ ุจุดูู ูุซุงูู ูุชุฏุฑูุจ ุงูููุงุฐุฌ. ูู ูุฐุง ุงููุณูุ ุณูุณุชูุดู ุงูููุฒุงุช ุงููุฎุชููุฉ ุงูุชู ุชููุฑูุง ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค ูุชูุธูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู.

<Youtube id="tqfSFcPMgOI"/>

## ุชูุทูุน ูุชูุทูุน ุจูุงูุงุชูุง

ุนูู ุบุฑุงุฑ Pandasุ ุชููุฑ ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค ุงูุนุฏูุฏ ูู ุงููุธุงุฆู ูุชุนุฏูู ูุญุชููุงุช ูุงุฆูุงุช `Dataset` ู`DatasetDict`. ููุฏ ูุงุฌููุง ุจุงููุนู ุทุฑููุฉ `Dataset.map()` ูู [ุงููุตู 3](/course/chapter3)ุ ููู ูุฐุง ุงููุณูุ ุณูุณุชูุดู ุจุนุถ ุงููุธุงุฆู ุงูุฃุฎุฑู ุงููุชุงุญุฉ ููุง.

ูู ูุฐุง ุงููุซุงูุ ุณูุณุชุฎุฏู [ูุฌููุนุฉ ุจูุงูุงุช ูุฑุงุฌุนุฉ ุงูุฃุฏููุฉ](https://archive.ics.uci.edu/ml/datasets/Drug+Review+Dataset+%28Drugs.com%29) ุงูุชู ุชุณุชุถูููุง [ูุณุชูุฏุน ุชุนูู ุงูุขูุฉ ุจุฌุงูุนุฉ ูุงููููุฑููุงุ ุฅูุฑููู](https://archive.ics.uci.edu/ml/index.php)ุ ูุงูุชู ุชุญุชูู ุนูู ูุฑุงุฌุนุงุช ุงููุฑุถู ุญูู ูุฎุชูู ุงูุฃุฏููุฉุ ุฅูู ุฌุงูุจ ุงูุญุงูุฉ ุงูุชู ูุชู ุนูุงุฌูุง ูุชุตููู ูู 10 ูุฌูู ูุฑุถุง ุงููุฑูุถ.

ุฃููุงูุ ูุญุชุงุฌ ุฅูู ุชูุฒูู ูุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุชุ ูุงูุชู ูููู ุงูููุงู ุจูุง ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ `wget` ู`unzip`:

```py
!wget "https://archive.ics.uci.edu/ml/machine-learning-databases/00462/drugsCom_raw.zip"
!unzip drugsCom_raw.zip
```

ูุธุฑูุง ูุฃู TSV ูู ูุฌุฑุฏ ูุชุบูุฑ ูู CSV ูุณุชุฎุฏู ุนูุงูุงุช ุงูุชุจููุจ ุจุฏูุงู ูู ุงูููุงุตู ููุงุตูุ ูููููุง ุชุญููู ูุฐู ุงููููุงุช ุจุงุณุชุฎุฏุงู ุจุฑูุงูุฌ ุชุญููู `csv` ูุชุญุฏูุฏ ุญุฌุฉ `delimiter` ูู ูุธููุฉ `load_dataset()` ููุง ููู:

```py
from datasets import load_dataset

data_files = {"train": "drugsComTrain_raw.tsv", "test": "drugsComTest_raw.tsv"}
# \t ูู ุญุฑู ุนูุงูุฉ ุงูุชุจููุจ ูู ุจุงูุซูู
drug_dataset = load_dataset("csv", data_files=data_files, delimiter="\t")
```

ุชุชูุซู ุงูููุงุฑุณุฉ ุงูุฌูุฏุฉ ุนูุฏ ุฅุฌุฑุงุก ุฃู ููุน ูู ุชุญููู ุงูุจูุงูุงุช ูู ุงูุญุตูู ุนูู ุนููุฉ ุนุดูุงุฆูุฉ ุตุบูุฑุฉ ููุญุตูู ุนูู ุดุนูุฑ ุณุฑูุน ุจููุน ุงูุจูุงูุงุช ุงูุชู ุชุนูู ุจูุง. ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐คุ ูููููุง ุฅูุดุงุก ุนููุฉ ุนุดูุงุฆูุฉ ุนู ุทุฑูู ุฑุจุท ูุธุงุฆู `Dataset.shuffle()` ู`Dataset.select()` ูุนูุง:

```py
drug_sample = drug_dataset["train"].shuffle(seed=42).select(range(1000))
# ุฅููุงุก ูุธุฑุฉ ุนูู ุงูุฃูุซูุฉ ุงูููููุฉ ุงูุฃููู
drug_sample[:3]
```

```python out
{'Unnamed: 0': [87571, 178045, 80482],
 'drugName': ['Naproxen', 'Duloxetine', 'Mobic'],
 'condition': ['Gout, Acute', 'ibromyalgia', 'Inflammatory Conditions'],
 'review': ['"like the previous person mention, I&#039;m a strong believer of aleve, it works faster for my gout than the prescription meds I take. No more going to the doctor for refills.....Aleve works!"',
  '"I have taken Cymbalta for about a year and a half for fibromyalgia pain. It is great\r\nas a pain reducer and an anti-depressant, however, the side effects outweighed \r\nany benefit I got from it. I had trouble with restlessness, being tired constantly,\r\ndizziness, dry mouth, numbness and tingling in my feet, and horrible sweating. I am\r\nbeing weaned off of it now. Went from 60 mg to 30mg and now to 15 mg. I will be\r\noff completely in about a week. The fibro pain is coming back, but I would rather deal with it than the side effects."',
  '"I have been taking Mobic for over a year with no side effects other than an elevated blood pressure.  I had severe knee and ankle pain which completely went away after taking Mobic.  I attempted to stop the medication however pain returned after a few days."'],
 'rating': [9.0, 3.0, 10.0],
 'date': ['September 2, 2015', 'November 7, 2011', 'June 5, 2013'],
 'usefulCount': [36, 13, 128]}
```

ูุงุญุธ ุฃููุง ูููุง ุจุชุซุจูุช ุงูุจุฐุฑุฉ ูู `Dataset.shuffle()` ูุฃุบุฑุงุถ ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงูุฅูุชุงุฌ. ูุชููุน `Dataset.select()` ูุชุบูุฑูุง ูุงุจููุง ููุญููุฉ ูู ุงููุคุดุฑุงุชุ ูุฐุง ูููุง ุจุชูุฑูุฑ `range(1000)` ูุงูุชูุงุท ุงูุฃูุซูุฉ ุงูู 1000 ุงูุฃููู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุฎููุทุฉ. ูู ูุฐู ุงูุนููุฉุ ูููููุง ุจุงููุนู ุฑุคูุฉ ุจุนุถ ุงูุบุฑุงุจุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง:

* ูุจุฏู ุนููุฏ `Unnamed: 0` ูุดุจูููุง ูุซู ูุนุฑู ูุฌููู ููู ูุฑูุถ.
* ูุชุถูู ุนููุฏ `condition` ูุฒูุฌูุง ูู ุงูุนูุงูุงุช ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ.
* ุชุฎุชูู ุงููุฑุงุฌุนุงุช ูู ุงูุทูู ูุชุญุชูู ุนูู ูุฒูุฌ ูู ููุงุตู ุงูุฃุณุทุฑ ุจุงูุซูู (`\r\n`) ุจุงูุฅุถุงูุฉ ุฅูู ุฑููุฒ ุงูุฃุญุฑู HTML ูุซู `&\#039;`.

ุฏุนููุง ูุฑู ููู ูููููุง ุงุณุชุฎุฏุงู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค ููุชุนุงูู ูุน ูู ูู ูุฐู ุงููุถุงูุง. ูุงุฎุชุจุงุฑ ูุฑุถูุฉ ูุนุฑู ุงููุฑูุถ ูุนููุฏ `Unnamed: 0`ุ ูููููุง ุงุณุชุฎุฏุงู ูุธููุฉ `Dataset.unique()` ููุชุญูู ูู ุฃู ุนุฏุฏ ุงููุนุฑูุงุช ูุชุทุงุจู ูุน ุนุฏุฏ ุงูุตููู ูู ูู ุชูุณูู:

```py
for split in drug_dataset.keys():
    assert len(drug_dataset[split]) == len(drug_dataset[split].unique("Unnamed: 0"))
```

ูุจุฏู ุฃู ูุฐุง ูุคูุฏ ูุฑุถูุฉ ูุฏููุงุ ูุฐูู ุฏุนููุง ูููู ุจุชูุธูู ูุฌููุนุฉ ุงูุจูุงูุงุช ููููุงู ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชุณููุฉ ุนููุฏ `Unnamed: 0` ุฅูู ุดูุก ุฃูุซุฑ ูุงุจููุฉ ููุชูุณูุฑ. ูููููุง ุงุณุชุฎุฏุงู ูุธููุฉ `DatasetDict.rename_column()` ูุฅุนุงุฏุฉ ุชุณููุฉ ุงูุนููุฏ ุนุจุฑ ููุง ุงูุชูุณูููู ูู ุฎุทูุฉ ูุงุญุฏุฉ:

```py
drug_dataset = drug_dataset.rename_column(
    original_column_name="Unnamed: 0", new_column_name="patient_id"
)
drug_dataset
```

```python out
DatasetDict({
    train: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount'],
        num_rows: 161297
    })
    test: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount'],
        num_rows: 53766
    })
})
```

<Tip>

โ๏ธ **ุฌุฑุจูุง!** ุงุณุชุฎุฏู ูุธููุฉ `Dataset.unique()` ููุนุซูุฑ ุนูู ุนุฏุฏ ุงูุฃุฏููุฉ ูุงูุญุงูุงุช ุงููุฑูุฏุฉ ูู ูุฌููุนุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ.

</Tip>

ุจุนุฏ ุฐููุ ุฏุนูุง ูููู ุจุชุทุจูุน ุฌููุน ุนูุงูุงุช `condition` ุจุงุณุชุฎุฏุงู `Dataset.map()`. ููุง ูุนููุง ูุน ุงูุชุฌุฒุฆุฉ ูู [ุงููุตู 3](/course/chapter3)ุ ูููููุง ุชุญุฏูุฏ ูุธููุฉ ุจุณูุทุฉ ูููู ุชุทุจูููุง ุนุจุฑ ุฌููุน ุงูุตููู ูู ูู ุชูุณูู ูู `drug_dataset`:

```py
def lowercase_condition(example):
    return {"condition": example["condition"].lower()}


drug_dataset.map(lowercase_condition)
```

```python out
AttributeError: 'NoneType' object has no attribute 'lower'
```

ูุง ุฅูููุ ููุฏ ูุงุฌููุง ูุดููุฉ ูุน ูุธููุฉ ุงูุฎุฑูุทุฉ ุงูุฎุงุตุฉ ุจูุง! ูู ุงูุฎุทุฃุ ูููููุง ุฃู ูุณุชูุชุฌ ุฃู ุจุนุถ ุงูุฅุฏุฎุงูุงุช ูู ุนููุฏ `condition` ูู `None`ุ ูุงูุชู ูุง ูููู ุชุญููููุง ุฅูู ุฃุญุฑู ุตุบูุฑุฉ ูุฃููุง ููุณุช ุณูุงุณู. ุฏุนูุง ูุชุฎูุต ูู ูุฐู ุงูุตููู ุจุงุณุชุฎุฏุงู `Dataset.filter()`ุ ูุงูุชู ุชุนูู ุจุทุฑููุฉ ููุงุซูุฉ ูู `Dataset.map()` ูุชุชููุน ูุธููุฉ ุชุชููู ูุซุงูุงู ูุงุญุฏูุง ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ุจุฏูุงู ูู ูุชุงุจุฉ ูุธููุฉ ุตุฑูุญุฉ ูุซู:

```py
def filter_nones(x):
    return x["condition"] is not None
```

ุซู ุชุดุบูู `drug_dataset.filter(filter_nones)`ุ ูููููุง ุงูููุงู ุจุฐูู ูู ุณุทุฑ ูุงุญุฏ ุจุงุณุชุฎุฏุงู _ุฏุงูุฉ ูุงูุฏุง_. ูู ุจุงูุซููุ ุฏุงูุงุช ูุงูุฏุง ูู ูุธุงุฆู ุตุบูุฑุฉ ููููู ุชุนุฑูููุง ุฏูู ุชุณููุชูุง ุตุฑุงุญุฉู. ุชุฃุฎุฐ ุงูุดูู ุงูุนุงู:

```
lambda <arguments> : <expression>
```

ุญูุซ `lambda` ูู ูุงุญุฏุฉ ูู ูููุงุช ุจุงูุซูู ุงูุฎุงุตุฉ [keywords](https://docs.python.org/3/reference/lexical_analysis.html#keywords)ุ `<arguments>` ูู ูุงุฆูุฉ/ูุฌููุนุฉ ูู ุงูููู ุงูููุตููุฉ ุจููุงุตู ุชุญุฏุฏ ุงููุฏุฎูุงุช ุฅูู ุงููุธููุฉุ ู`<expression>` ุชูุซู ุงูุนูููุงุช ุงูุชู ุชุฑุบุจ ูู ุชูููุฐูุง. ุนูู ุณุจูู ุงููุซุงูุ ูููููุง ุชุญุฏูุฏ ุฏุงูุฉ ูุงูุฏุง ุจุณูุทุฉ ุชุฑุจูุน ุฑูู ููุง ููู:

```
lambda x : x * x
```

ูุชุทุจูู ูุฐู ุงููุธููุฉ ุนูู ุฅุฏุฎุงูุ ูุญุชุงุฌ ุฅูู ุชุบููููุง ูุงูุฅุฏุฎุงู ูู ุงูุฃููุงุณ:

```py
(lambda x: x * x)(3)
```

```python out
9
```

ูุจุงููุซูุ ูููููุง ุชุญุฏูุฏ ุฏุงูุงุช ูุงูุฏุง ูุน ุงูุนุฏูุฏ ูู ุงูุญุฌุฌ ุนู ุทุฑูู ูุตููุง ุจููุงุตู. ุนูู ุณุจูู ุงููุซุงูุ ูููููุง ุญุณุงุจ ูุณุงุญุฉ ุงููุซูุซ ููุง ููู:

```py
(lambda base, height: 0.5 * base * height)(4, 8)
```

```python out
16.0
```

ุฏุงูุงุช ูุงูุฏุง ูููุฏุฉ ุนูุฏูุง ุชุฑูุฏ ุชุญุฏูุฏ ูุธุงุฆู ุตุบูุฑุฉ ููุงุณุชุฎุฏุงู ูุฑุฉ ูุงุญุฏุฉ (ููุฒูุฏ ูู ุงููุนูููุงุช ุนููุงุ ููุตู ุจูุฑุงุกุฉ ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุงูููุชุงุฒ [Real Python tutorial](https://realpython.com/python-lambda/) ุจูุงุณุทุฉ Andre Burgaud). ูู ุณูุงู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐คุ ูููููุง ุงุณุชุฎุฏุงู ุฏุงูุงุช ูุงูุฏุง ูุชุญุฏูุฏ ุนูููุงุช ุงูุฎุฑูุทุฉ ูุงูุชุตููุฉ ุงูุจุณูุทุฉุ ูุฐุง ุฏุนูุง ูุณุชุฎุฏู ูุฐู ุงูุญููุฉ ูููุถุงุก ุนูู ุฅุฏุฎุงูุงุช `None` ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง:

```py
drug_dataset = drug_dataset.filter(lambda x: x["condition"] is not None)
```
ุจุนุฏ ุฅุฒุงูุฉ ุงูุฅุฏุฎุงูุงุช `None`ุ ูููููุง ุชุทุจูุน ุนููุฏ `condition` ูุฏููุง:

```py
drug_dataset = drug_dataset.map(lowercase_condition)
# ุชุญูู ูู ุฃู ุงูุชุญููู ุฅูู ุญุฑูู ุตุบูุฑุฉ ูุฏ ุชู ุจูุฌุงุญ
drug_dataset["train"]["condition"][:3]
```

```python out
['left ventricular dysfunction', 'adhd', 'birth control']
```

ููุฏ ูุฌุญุช ุงูุนูููุฉ! ุงูุขู ุจุนุฏ ุฃู ูููุง ุจุชูุธูู ุงูุชุตูููุงุชุ ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุชูุธูู ุงููุฑุงุฌุนุงุช ููุณูุง.

## ุฅูุดุงุก ุฃุนูุฏุฉ ุฌุฏูุฏุฉ[[creating-new-columns]]

ุนูุฏ ุงูุชุนุงูู ูุน ูุฑุงุฌุนุงุช ุงูุนููุงุกุ ูู ุงูููุงุฑุณุงุช ุงูุฌูุฏุฉ ุงูุชุญูู ูู ุนุฏุฏ ุงููููุงุช ูู ูู ูุฑุงุฌุนุฉ. ูุฏ ุชููู ุงููุฑุงุฌุนุฉ ูุฌุฑุฏ ูููุฉ ูุงุญุฏุฉ ูุซู "ุฑุงุฆุน!" ุฃู ููุงู ูุงูู ูุญุชูู ุนูู ุขูุงู ุงููููุงุชุ ูุงุนุชูุงุฏุงู ุนูู ุญุงูุฉ ุงูุงุณุชุฎุฏุงูุ ุณุชุญุชุงุฌ ุฅูู ุงูุชุนุงูู ูุน ูุฐู ุงูุญุงูุงุช ุงููุชุทุฑูุฉ ุจุดูู ูุฎุชูู. ูุญุณุงุจ ุนุฏุฏ ุงููููุงุช ูู ูู ูุฑุงุฌุนุฉุ ุณูุณุชุฎุฏู ุชูุฑูุจูุง ุชูุฑูุจููุง ูุนุชูุฏ ุนูู ุชูุณูู ูู ูุต ุญุณุจ ุงููุณุงูุฉ ุงูุจูุถุงุก.

ุฏุนูุง ูุญุฏุฏ ุฏุงูุฉ ุจุณูุทุฉ ุชููู ุจุญุณุงุจ ุนุฏุฏ ุงููููุงุช ูู ูู ูุฑุงุฌุนุฉ:

```py
def compute_review_length(example):
    return {"review_length": len(example["review"].split())}
```

ุนูู ุนูุณ ุฏุงูุชูุง `lowercase_condition()`ุ ูุฅู ุฏุงูุฉ `compute_review_length()` ุชุนูุฏ ูุงููุณูุง ูุง ุชุชุทุงุจู ููู ุงูููุชุงุญ ูุน ุฃุญุฏ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ูู ูุฐู ุงูุญุงูุฉุ ุนูุฏูุง ูุชู ุชูุฑูุฑ `compute_review_length()` ุฅูู `Dataset.map()`ุ ุณูุชู ุชุทุจูููุง ุนูู ุฌููุน ุงูุตููู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฅูุดุงุก ุนููุฏ ุฌุฏูุฏ ูุณูู `review_length`:

```py
drug_dataset = drug_dataset.map(compute_review_length)
# ุชููุฏ ูุซุงู ุงูุชุฏุฑูุจ ุงูุฃูู
drug_dataset["train"][0]
```

```python out
{'patient_id': 206461,
 'drugName': 'Valsartan',
 'condition': 'left ventricular dysfunction',
 'review': '"It has no side effect, I take it in combination of Bystolic 5 Mg and Fish Oil"',
 'rating': 9.0,
 'date': 'May 20, 2012',
 'usefulCount': 27,
 'review_length': 17}
```

ููุง ูู ูุชููุนุ ูููููุง ุฑุคูุฉ ุนููุฏ `review_length` ุงูุฐู ุชู ุฅุถุงูุชู ุฅูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจูุง. ูููููุง ูุฑุฒ ูุฐุง ุงูุนููุฏ ุงูุฌุฏูุฏ ุจุงุณุชุฎุฏุงู `Dataset.sort()` ููุนุฑูุฉ ุดูู ุงูููู ุงููุชุทุฑูุฉ:

```py
drug_dataset["train"].sort("review_length")[:3]
```

```python out
{'patient_id': [103488, 23627, 20558],
 'drugName': ['Loestrin 21 1 / 20', 'Chlorzoxazone', 'Nucynta'],
 'condition': ['birth control', 'muscle spasm', 'pain'],
 'review': ['"Excellent."', '"useless"', '"ok"'],
 'rating': [10.0, 1.0, 6.0],
 'date': ['November 4, 2008', 'March 24, 2017', 'August 20, 2016'],
 'usefulCount': [5, 2, 10],
 'review_length': [1, 1, 1]}
```

ููุง ุงุดุชุจููุงุ ุชุญุชูู ุจุนุถ ุงููุฑุงุฌุนุงุช ุนูู ูููุฉ ูุงุญุฏุฉ ููุทุ ูุงูุชูุ ุนูู ุงูุฑุบู ูู ุฃููุง ูุฏ ุชููู ููุงุณุจุฉ ูุชุญููู ุงููุดุงุนุฑุ ูู ุชููู ูููุฏุฉ ุฅุฐุง ุฃุฑุฏูุง ุงูุชูุจุค ุจุงูุญุงูุฉ.

<Tip>

๐ ููุงู ุทุฑููุฉ ุจุฏููุฉ ูุฅุถุงูุฉ ุฃุนูุฏุฉ ุฌุฏูุฏุฉ ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ููู ุงุณุชุฎุฏุงู ุฏุงูุฉ `Dataset.add_column()`ุ ูุงูุชู ุชุณูุญ ูู ุจุชูููุฑ ุงูุนููุฏ ููุงุฆูุฉ ุจุงูุซูู ุฃู ูุตูููุฉ ูููุจูุ ููููู ุฃู ุชููู ูููุฏุฉ ูู ุงูุญุงูุงุช ุงูุชู ูุง ุชูุงุณุจ ูููุง ุฏุงูุฉ `Dataset.map()` ุชุญูููู.

</Tip>

ุฏุนูุง ูุณุชุฎุฏู ุฏุงูุฉ `Dataset.filter()` ูุฅุฒุงูุฉ ุงููุฑุงุฌุนุงุช ุงูุชู ุชุญุชูู ุนูู ุฃูู ูู 30 ูููุฉ. ุนูู ุบุฑุงุฑ ูุง ูุนููุงู ูุน ุนููุฏ `condition`ุ ูููููุง ุชุตููุฉ ุงููุฑุงุฌุนุงุช ุงููุตูุฑุฉ ุฌุฏูุง ูู ุฎูุงู ุงุดุชุฑุงุท ุฃู ูููู ุทูู ุงููุฑุงุฌุนุงุช ุฃุนูู ูู ูุฐู ุงูุนุชุจุฉ:

```py
drug_dataset = drug_dataset.filter(lambda x: x["review_length"] > 30)
print(drug_dataset.num_rows)
```

```python out
{'train': 138514, 'test': 46108}
```

ููุง ุชุฑูุ ููุฏ ุฃุฒุงู ูุฐุง ุญูุงูู 15% ูู ุงููุฑุงุฌุนุงุช ูู ูุฌููุนุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ ุงูุฃุตููุฉ.

<Tip>

โ๏ธ **ุฌุฑุจูุง!** ุงุณุชุฎุฏู ุฏุงูุฉ `Dataset.sort()` ููุญุต ุงููุฑุงุฌุนุงุช ุงูุชู ุชุญุชูู ุนูู ุฃูุจุฑ ุนุฏุฏ ูู ุงููููุงุช. ุฑุงุฌุน [ุงููุซุงุฆู](https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.sort) ููุนุฑูุฉ ุงูุญุฌุฉ ุงูุชู ุชุญุชุงุฌูุง ููุฑุฒ ุงููุฑุงุฌุนุงุช ุญุณุจ ุงูุทูู ุจุชุฑุชูุจ ุชูุงุฒูู.

</Tip>

ุงูุดูุก ุงูุฃุฎูุฑ ุงูุฐู ูุญุชุงุฌ ุฅูู ุงูุชุนุงูู ูุนู ูู ูุฌูุฏ ุฑููุฒ HTML ูู ูุฑุงุฌุนุงุชูุง. ูููููุง ุงุณุชุฎุฏุงู ูุญุฏุฉ HTML ูู ุจุงูุซูู ููู ุฑููุฒ ูุฐู ุงูุฃุญุฑูุ ููุง ููู:

```py
import html

text = "I&#039;m a transformer called BERT"
html.unescape(text)
```

```python out
"I'm a transformer called BERT"
```

ุณูุณุชุฎุฏู `Dataset.map()` ููู ุฑููุฒ ุฌููุน ุฃุญุฑู HTML ูู ูู ูุฌููุนุชูุง:

```python
drug_dataset = drug_dataset.map(lambda x: {"review": html.unescape(x["review"])})
```

ููุง ุชุฑูุ ูุฅู ุทุฑููุฉ `Dataset.map()` ูููุฏุฉ ุฌุฏูุง ููุนุงูุฌุฉ ุงูุจูุงูุงุช - ููู ูุจุฏุฃ ุญุชู ูู ุงุณุชูุดุงู ูู ูุง ูููููุง ูุนูู!

## ุงูููู ุงูุฎุงุฑูุฉ ูุทุฑููุฉ `map()`[[the-map-methods-superpowers]]

ุชุฃุฎุฐ ุทุฑููุฉ `Dataset.map()` ุญุฌุฉ `batched` ูุงูุชูุ ุฅุฐุง ุชู ุชุนููููุง ุฅูู `True`ุ ุชุชุณุจุจ ูู ุฅุฑุณุงู ุฏูุนุฉ ูู ุงูุฃูุซูุฉ ุฅูู ุฏุงูุฉ ุงูุฎุฑูุทุฉ ูู ููุช ูุงุญุฏ (ุญุฌู ุงูุฏูุนุฉ ูุงุจู ููุชูููู ูููู ุงูุงูุชุฑุงุถู ูู 1,000). ุนูู ุณุจูู ุงููุซุงูุ ุงุณุชุบุฑูุช ุฏุงูุฉ ุงูุฎุฑูุทุฉ ุงูุณุงุจูุฉ ุงูุชู ููุช ุฑููุฒ ุฌููุน ุฃุญุฑู HTML ุจุนุถ ุงูููุช ูุชุดุบูููุง (ููููู ูุฑุงุกุฉ ุงูููุช ุงููุณุชุบุฑู ูู ุฃุดุฑุทุฉ ุงูุชูุฏู). ูููููุง ุชุณุฑูุน ุฐูู ูู ุฎูุงู ูุนุงูุฌุฉ ุนุฏุฉ ุนูุงุตุฑ ูู ููุณ ุงูููุช ุจุงุณุชุฎุฏุงู ูุงุฆูุฉ ุงูููู.

ุนูุฏูุง ุชุญุฏุฏ `batched=True`ุ ุชุชููู ุงูุฏุงูุฉ ูุงููุณูุง ูุน ุญููู ูุฌููุนุฉ ุงูุจูุงูุงุชุ ูููู ูู ูููุฉ ุงูุขู ูู _ูุงุฆูุฉ ูู ุงูููู_ุ ูููุณุช ูููุฉ ูุงุญุฏุฉ ููุท. ูุฌุจ ุฃู ุชููู ูููุฉ ุงูุฅุฑุฌุงุน ูู `Dataset.map()` ูู ููุณูุง: ูุงููุณ ูุน ุงูุญููู ุงูุชู ูุฑูุฏ ุชุญุฏูุซูุง ุฃู ุฅุถุงูุชูุง ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฏููุงุ ููุงุฆูุฉ ูู ุงูููู. ุนูู ุณุจูู ุงููุซุงูุ ุฅููู ุทุฑููุฉ ุฃุฎุฑู ููู ุฑููุฒ ุฌููุน ุฃุญุฑู HTMLุ ูููู ุจุงุณุชุฎุฏุงู `batched=True`:

```python
new_drug_dataset = drug_dataset.map(
    lambda x: {"review": [html.unescape(o) for o in x["review"]]}, batched=True
)
```

ุฅุฐุง ููุช ุชุดุบู ูุฐุง ุงูููุฏ ูู ุฏูุชุฑ ููุงุญุธุงุชุ ูุณุชุฑู ุฃู ูุฐุง ุงูุฃูุฑ ูููุฐ ุจุดูู ุฃุณุฑุน ุจูุซูุฑ ูู ุงูุฃูุฑ ุงูุณุงุจู. ูููุณ ูุฃู ูุฑุงุฌุนุงุชูุง ูุฏ ุชู ูู ุฑููุฒ HTML ุงูุฎุงุตุฉ ุจูุง ุจุงููุนู - ุฅุฐุง ููุช ุจุฅุนุงุฏุฉ ุชูููุฐ ุงูุชุนูููุงุช ูู ุงููุณู ุงูุณุงุจู (ุจุฏูู `batched=True`)ุ ูุณูุณุชุบุฑู ููุณ ุงูููุช ููุง ูุงู ูู ูุจู. ููุฑุฌุน ุฐูู ุฅูู ุฃู ููุงุฆู ุงูููู ุชููู ุนุงุฏุฉ ุฃุณุฑุน ูู ุชูููุฐ ููุณ ุงูููุฏ ูู ุญููุฉ `for`ุ ููุง ุฃููุง ูุญุตู ุนูู ุจุนุถ ุงูุฃุฏุงุก ูู ุฎูุงู ุงููุตูู ุฅูู ุงููุซูุฑ ูู ุงูุนูุงุตุฑ ูู ููุณ ุงูููุช ุจุฏูุงู ูู ูุงุญุฏ ุชูู ุงูุขุฎุฑ.

ุงุณุชุฎุฏุงู `Dataset.map()` ูุน `batched=True` ุณูููู ุถุฑูุฑููุง ููุชุญ ุณุฑุนุฉ ุงููุญููุงุช "ุงูุณุฑูุนุฉ" ุงูุชู ุณูุตุงุฏููุง ูู [ุงููุตู 6](/course/chapter6)ุ ูุงูุชู ูููููุง ุชููููุฒ ููุงุฆู ูุจูุฑุฉ ูู ุงููุตูุต ุจุณุฑุนุฉ. ุนูู ุณุจูู ุงููุซุงูุ ูุชููููุฒ ุฌููุน ูุฑุงุฌุนุงุช ุงูุฃุฏููุฉ ุจุงุณุชุฎุฏุงู ูุญูู ุณุฑูุนุ ูููููุง ุงุณุชุฎุฏุงู ุฏุงูุฉ ูุซู ูุฐู:

```python
from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("bert-base-cased")


def tokenize_function(examples):
    return tokenizer(examples["review"], truncation=True)
```

ููุง ุฑุฃูุช ูู [ุงููุตู 3](/course/chapter3)ุ ูููููุง ุชูุฑูุฑ ูุซุงู ูุงุญุฏ ุฃู ุนุฏุฉ ุฃูุซูุฉ ุฅูู ุงููุญููุ ูุฐูู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงูุฏุงูุฉ ูุน ุฃู ุจุฏูู `batched=True`. ุฏุนูุง ูุบุชูู ูุฐู ุงููุฑุตุฉ ูููุงุฑูุฉ ุฃุฏุงุก ุงูุฎูุงุฑุงุช ุงููุฎุชููุฉ. ูู ุฏูุชุฑ ุงูููุงุญุธุงุชุ ููููู ุชูููุช ุชุนูููุงุช ุณุทุฑ ูุงุญุฏ ุนู ุทุฑูู ุฅุถุงูุฉ `%time` ูุจู ุณุทุฑ ุงูููุฏ ุงูุฐู ุชุฑูุฏ ููุงุณู:

```python no-format
%time tokenized_dataset = drug_dataset.map(tokenize_function, batched=True)
```
ููููู ุฃูุถุงู ุชูููุช ุฎููุฉ ูุงููุฉ ุจูุถุน `%%time` ูู ุจุฏุงูุฉ ุงูุฎููุฉ. ุนูู ุงูุฃุฌูุฒุฉ ุงูุชู ูููุง ุจุชูููุฐูุง ุนูููุงุ ุฃุธูุฑุช 10.8 ุซุงููุฉ ููุฐู ุงูุชุนูููุงุช (ููู ุงูุฑูู ุงูููุชูุจ ุจุนุฏ "Wall time").

<ูุตูุญุฉ>

โ๏ธ **ุฌุฑุจูุง!** ููุฐ ููุณ ุงูุชุนูููุงุช ูุน ูุจุฏูู `batched=True`ุ ุซู ุฌุฑุจูุง ูุน ูุญูู ูุบูู ุจุทูุก (ุฃุถู `use_fast=False` ูู ุทุฑููุฉ `AutoTokenizer.from_pretrained()`) ุญุชู ุชุฑู ุงูุฃุฑูุงู ุงูุชู ุชุญุตู ุนูููุง ุนูู ุฃุฌูุฒุชู.

</ูุตูุญุฉ>

ููุง ุงููุชุงุฆุฌ ุงูุชู ุญุตููุง ุนูููุง ูุน ูุจุฏูู ุชุฌููุนุ ูุน ูุญูู ูุบูู ุณุฑูุน ูุขุฎุฑ ุจุทูุก:

ุงูุฎูุงุฑุงุช         | ูุญูู ูุบูู ุณุฑูุน | ูุญูู ูุบูู ุจุทูุก
:--------------:|:--------------:|:-------------:
`batched=True`  | 10.8 ุซุงููุฉ          | 4 ุฏูุงุฆู ู41 ุซุงููุฉ
`batched=False` | 59.2 ุซุงููุฉ          | 5 ุฏูุงุฆู ู3 ุซูุงูู

ูุฐุง ูุนูู ุฃู ุงุณุชุฎุฏุงู ูุญูู ูุบูู ุณุฑูุน ูุน ุฎูุงุฑ `batched=True` ุฃุณุฑุน 30 ูุฑุฉ ูู ูุธูุฑู ุงูุจุทูุก ุจุฏูู ุชุฌููุน -- ูุฐุง ูุฐูู ุญูุงู! ูุฐุง ูู ุงูุณุจุจ ุงูุฑุฆูุณู ุงูุฐู ูุฌุนู ุงููุญููุงุช ุงููุบููุฉ ุงูุณุฑูุนุฉ ูู ุงูุงูุชุฑุงุถูุฉ ุนูุฏ ุงุณุชุฎุฏุงู `AutoTokenizer` (ููุฐุง ูู ุณุจุจ ุชุณููุชูุง "ุณุฑูุนุฉ"). ูููููุง ุชุญููู ูุซู ูุฐู ุงูุณุฑุนุฉ ูุฃู ููุฏ ุงูุชุญููู ุงููุบูู ูุชู ุชูููุฐู ูู ุงูุฎูููุฉ ุจูุบุฉ Rustุ ููู ูุบุฉ ุชุฌุนู ูู ุงูุณูู ููุงุฒูุฉ ุชูููุฐ ุงูููุฏ.

ุงูููุงุฒูุฉ ูู ุฃูุถุงู ุงูุณุจุจ ูู ุชุญููู ุงููุญูู ุงููุบูู ุงูุณุฑูุน ูุณุฑุนุฉ 6 ูุฑุงุช ุชูุฑูุจุงู ูุน ุงูุชุฌููุน: ูุง ููููู ููุงุฒูุฉ ุนูููุฉ ุชุญููู ูุบูู ูุงุญุฏุฉุ ูููู ุนูุฏูุง ุชุฑูุฏ ุชุญููู ูุตูุต ูุซูุฑุฉ ูู ููุณ ุงูููุช ููููู ููุท ุชูุณูู ุงูุชูููุฐ ุนุจุฑ ุนุฏุฉ ุนูููุงุชุ ูู ูููุง ูุณุคููุฉ ุนู ูุตูุตูุง ุงูุฎุงุตุฉ.

`Dataset.map()` ูุฏูู ุฃูุถุงู ุจุนุถ ูุฏุฑุงุช ุงูููุงุฒูุฉ ุงูุฎุงุตุฉ ุจู. ุจูุง ุฃููุง ูุง ุชุฏุนููุง Rustุ ููู ุชุณูุญ ููุญูู ูุบูู ุจุทูุก ุจุงููุญุงู ุจูุญูู ูุบูู ุณุฑูุนุ ูููููุง ูููู ุฃู ุชููู ูููุฏุฉ (ุฎุงุตุฉ ุฅุฐุง ููุช ุชุณุชุฎุฏู ูุญูู ูุบูู ููุณ ูู ูุณุฎุฉ ุณุฑูุนุฉ). ูุชูููู ุชุนุฏุฏ ุงูุนูููุงุชุ ุงุณุชุฎุฏู ุญุฌุฉ `num_proc` ูุญุฏุฏ ุนุฏุฏ ุงูุนูููุงุช ุงูุชู ุชุฑูุฏ ุงุณุชุฎุฏุงููุง ูู ุงุณุชุฏุนุงุฆู ูู `Dataset.map()`:

```py
slow_tokenizer = AutoTokenizer.from_pretrained("bert-base-cased", use_fast=False)


def slow_tokenize_function(examples):
    return slow_tokenizer(examples["review"], truncation=True)


tokenized_dataset = drug_dataset.map(slow_tokenize_function, batched=True, num_proc=8)
```

ููููู ุงูุชุฌุฑุจุฉ ููููุงู ูุน ุงูุชูููุช ูุชุญุฏูุฏ ุงูุนุฏุฏ ุงูุฃูุซู ููุนูููุงุช ุงูุชู ูุฌุจ ุงุณุชุฎุฏุงููุงุ ูู ุญุงูุชูุงุ ุจุฏุง ุฃู 8 ุชูุชุฌ ุฃูุถู ููุณุจ ูู ุงูุณุฑุนุฉ. ููุง ุงูุฃุฑูุงู ุงูุชู ุญุตููุง ุนูููุง ูุน ูุจุฏูู ุชุนุฏุฏ ุงูุนูููุงุช:

ุงูุฎูุงุฑุงุช         | ูุญูู ูุบูู ุณุฑูุน | ูุญูู ูุบูู ุจุทูุก
:--------------:|:--------------:|:-------------:
`batched=True`  | 10.8 ุซุงููุฉ          | 4 ุฏูุงุฆู ู41 ุซุงููุฉ
`batched=False` | 59.2 ุซุงููุฉ          | 5 ุฏูุงุฆู ู3 ุซูุงูู
`batched=True`, `num_proc=8`  | 6.52 ุซุงููุฉ          | 41.3 ุซุงููุฉ
`batched=False`, `num_proc=8` | 9.49 ุซุงููุฉ          | 45.2 ุซุงููุฉ

ูุฐู ูุชุงุฆุฌ ุฃูุซุฑ ููุทููุฉ ูููุญูู ุงููุบูู ุงูุจุทูุกุ ูููู ุฃุฏุงุก ุงููุญูู ุงููุบูู ุงูุณุฑูุน ุชุญุณู ุฃูุถุงู ุจุดูู ูุจูุฑ. ูุงุญุธุ ูุน ุฐููุ ุฃู ูุฐุง ูู ูููู ุงูุญุงู ุฏุงุฆูุงู -- ุจุงููุณุจุฉ ูููู `num_proc` ุงูุฃุฎุฑู ุบูุฑ 8ุ ุฃุธูุฑุช ุงุฎุชุจุงุฑุงุชูุง ุฃูู ูุงู ุฃุณุฑุน ูุงุณุชุฎุฏุงู `batched=True` ุจุฏูู ูุฐุง ุงูุฎูุงุฑ. ุจุดูู ุนุงูุ ูุง ููุตู ุจุงุณุชุฎุฏุงู ุชุนุฏุฏ ุงูุนูููุงุช ูู ุจุงูุซูู ูููุญููุงุช ุงููุบููุฉ ุงูุณุฑูุนุฉ ูุน `batched=True`.

<ูุตูุญุฉ>

ุงุณุชุฎุฏุงู `num_proc` ูุชุณุฑูุน ูุนุงูุฌุชู ููุฑุฉ ุฑุงุฆุนุฉ ุนุงุฏุฉูุ ุทุงููุง ุฃู ุงูุฏุงูุฉ ุงูุชู ุชุณุชุฎุฏููุง ูุง ุชููู ุจุงููุนู ุจุจุนุถ ุฃููุงุน ุชุนุฏุฏ ุงูุนูููุงุช ุงูุฎุงุตุฉ ุจูุง.

</ูุตูุญุฉ>

ูู ูุฐู ุงููุธุงุฆู ุงูููุซูุฉ ูู ุทุฑููุฉ ูุงุญุฏุฉ ูุฐููุฉ ุจุงููุนูุ ูููู ููุงู ุงููุฒูุฏ! ูุน `Dataset.map()` ู`batched=True` ููููู ุชุบููุฑ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ูุฌููุนุฉ ุจูุงูุงุชู. ูุฐุง ูููุฏ ููุบุงูุฉ ูู ุงูุนุฏูุฏ ูู ุงูููุงูู ุงูุชู ุชุฑูุฏ ูููุง ุฅูุดุงุก ุนุฏุฉ ุฎุตุงุฆุต ุชุฏุฑูุจูุฉ ูู ูุซุงู ูุงุญุฏุ ูุณูุญุชุงุฌ ุฅูู ุงูููุงู ุจุฐูู ูุฌุฒุก ูู ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ูุนุฏุฉ ููุงู NLP ุณูููู ุจูุง ูู [ุงููุตู 7](/course/chapter7).

<ูุตูุญุฉ>

๐ก ูู ุงูุชุนูู ุงูุขููุ ุนุงุฏุฉู ูุง ูุชู ุชุนุฑูู _ุงููุซุงู_ ุนูู ุฃูู ูุฌููุนุฉ _ุงูุฎุตุงุฆ_ุต ุงูุชู ูุบุฐููุง ูููููุฐุฌ. ูู ุจุนุถ ุงูุณูุงูุงุชุ ุณุชููู ูุฐู ุงูุฎุตุงุฆุต ูู ูุฌููุนุฉ ุงูุฃุนูุฏุฉ ูู `Dataset`ุ ูููู ูู ุณูุงูุงุช ุฃุฎุฑู (ูุซู ููุง ูููุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ)ุ ูููู ุงุณุชุฎุฑุงุฌ ุนุฏุฉ ุฎุตุงุฆุต ูู ูุซุงู ูุงุญุฏ ูุชูุชูู ุฅูู ุนููุฏ ูุงุญุฏ.

</ูุตูุญุฉ>

ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุนูููุง! ููุง ุณูุญูู ุฃูุซูุฉูุง ูููุทุนูุง ุฅูู ุทูู ุฃูุตู 128ุ ูููููุง ุณูุทูุจ ูู ุงููุญูู ุงููุบูู ุฃู ูุนูุฏ *ูู* ุฃุฌุฒุงุก ุงููุตูุต ุจุฏูุงู ูู ุงูุฌุฒุก ุงูุฃูู ููุท. ูููู ุงูููุงู ุจุฐูู ูุน `return_overflowing_tokens=True`:

```py
def tokenize_and_split(examples):
    return tokenizer(
        examples["review"],
        truncation=True,
        max_length=128,
        return_overflowing_tokens=True,
    )
```

ุฏุนูุง ูุฌุฑุจ ูุฐุง ุนูู ูุซุงู ูุงุญุฏ ูุจู ุงุณุชุฎุฏุงู `Dataset.map()` ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุงููุงูู:

```py
result = tokenize_and_split(drug_dataset["train"][0])
[len(inp) for inp in result["input_ids"]]
```

```python out
[128, 49]
```

ูุฐููุ ุฃุตุจุญ ูุซุงููุง ุงูุฃูู ูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ ููููุงู ูู ุฎุงุตูุชูู ูุฃูู ุชู ุชุญูููู ุฅูู ุฃูุซุฑ ูู ุงูุนุฏุฏ ุงูุฃูุตู ููุฑููุฒ ุงูุชู ุญุฏุฏูุงูุง: ุงูุฃูู ุจุทูู 128 ูุงูุซุงูู ุจุทูู 49. ุงูุขู ุฏุนูุง ููุนู ูุฐุง ูุฌููุน ุนูุงุตุฑ ูุฌููุนุฉ ุงูุจูุงูุงุช!

```py
tokenized_dataset = drug_dataset.map(tokenize_and_split, batched=True)
```

```python out
ArrowInvalid: Column 1 named condition expected length 1463 but got length 1000
```

ุขู ูุง! ูุฐุง ูู ููุฌุญ! ููุงุฐุงุ ุจุงููุธุฑ ุฅูู ุฑุณุงูุฉ ุงูุฎุทุฃ ุณูุนุทููุง ุชูููุญุงู: ููุงู ุนุฏู ุชุทุงุจู ูู ุฃุทูุงู ุฃุญุฏ ุงูุฃุนูุฏุฉุ ูุงุญุฏ ุจุทูู 1,463 ูุงูุขุฎุฑ ุจุทูู 1,000. ุฅุฐุง ููุช ูุฏ ูุธุฑุช ุฅูู `Dataset.map()` [ุงููุซุงุฆู](https://huggingface.co/docs/datasets/package_reference/main_classes#datasets.Dataset.map)ุ ููุฏ ุชุชุฐูุฑ ุฃูู ุนุฏุฏ ุงูุนููุงุช ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุงูุฏุงูุฉ ุงูุชู ูููู ุจุชุนููููุงุ ููุง ูุฐู ุงูู 1,000 ูุซุงู ุฃุนุทุช 1,463 ุฎุงุตูุฉ ุฌุฏูุฏุฉุ ููุง ุฃุฏู ุฅูู ุฎุทุฃ ูู ุงูุดูู.

ุงููุดููุฉ ูู ุฃููุง ูุญุงูู ุฎูุท ูุฌููุนุชูู ูุฎุชููุชูู ูู ุงูุจูุงูุงุช ุจุฃุญุฌุงู ูุฎุชููุฉ: ุฃุนูุฏุฉ `drug_dataset` ุณูููู ููุง ุนุฏุฏ ูุนูู ูู ุงูุฃูุซูุฉ (ุงูู 1,000 ูู ุฎุทุฃูุง)ุ ูููู `tokenized_dataset` ุงูุชู ูุจูููุง ุณูููู ููุง ุฃูุซุฑ (ุงูู 1,463 ูู ุฑุณุงูุฉ ุงูุฎุทุฃุ ุฅูู ุฃูุซุฑ ูู 1,000 ูุฃููุง ูููู ุจุชุญููู ูุฑุงุฌุนุงุช ุทูููุฉ ุฅูู ุฃูุซุฑ ูู ูุซุงู ูุงุญุฏ ุจุงุณุชุฎุฏุงู `return_overflowing_tokens=True`). ูุฐุง ูุง ูุนูู ููุฌููุนุฉ ุจูุงูุงุชุ ูุฐูู ูุญุชุงุฌ ุฅูุง ุฅูู ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ ุฃู ุฌุนููุง ุจููุณ ุงูุญุฌู ููุง ูู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ. ูููููุง ุงูููุงู ุจุงูุฃูู ูุน ุญุฌุฉ `remove_columns`:

```py
tokenized_dataset = drug_dataset.map(
    tokenize_and_split, batched=True, remove_columns=drug_dataset["train"].column_names
)
```

ุงูุขู ูุฐุง ูุนูู ุจุฏูู ุฎุทุฃ. ูููููุง ุงูุชุญูู ูู ุฃู ูุฌููุนุฉ ุจูุงูุงุชูุง ุงูุฌุฏูุฏุฉ ูุฏููุง ุงูุนุฏูุฏ ูู ุงูุนูุงุตุฑ ุฃูุซุฑ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ุนู ุทุฑูู ููุงุฑูุฉ ุงูุฃุทูุงู:

```py
len(tokenized_dataset["train"]), len(drug_dataset["train"])
```

```python out
(206772, 138514)
```

ุฐูุฑูุง ุฃููุง ูููููุง ุฃูุถุงู ุงูุชุนุงูู ูุน ูุดููุฉ ุนุฏู ุชุทุงุจู ุงูุทูู ุจุฌุนู ุงูุฃุนูุฏุฉ ุงููุฏููุฉ ุจููุณ ุญุฌู ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ. ููููุงู ุจุฐููุ ุณูุญุชุงุฌ ุฅูู ุญูู `overflow_to_sample_mapping` ุงูุฐู ูุนูุฏู ุงููุญูู ุงููุบูู ุนูุฏูุง ูุญุฏุฏ `return_overflowing_tokens=True`. ูุนุทููุง ุฎุฑูุทุฉ ูู ููุฑุณ ุฎุงุตูุฉ ุฌุฏูุฏุฉ ุฅูู ููุฑุณ ุงูุนููุฉ ุงูุชู ูุดุฃุช ูููุง. ุจุงุณุชุฎุฏุงู ูุฐุงุ ูููููุง ุฑุจุท ูู ููุชุงุญ ููุฌูุฏ ูู ูุฌููุนุฉ ุจูุงูุงุชูุง ุงูุฃุตููุฉ ุจูุงุฆูุฉ ูู ุงูููู ุจุงูุญุฌู ุงูุตุญูุญ ุนู ุทุฑูู ุชูุฑุงุฑ ููู ูู ูุซุงู ุจูุฏุฑ ูุง ููุชุฌ ูู ุฎุตุงุฆุต ุฌุฏูุฏุฉ:

```py
def tokenize_and_split(examples):
    result = tokenizer(
        examples["review"],
        truncation=True,
        max_length=128,
        return_overflowing_tokens=True,
    )
    # ุงุณุชุฎุฑุฌ ุงูุฎุฑูุทุฉ ุจูู ุงูููุงุฑุณ ุงูุฌุฏูุฏุฉ ูุงููุฏููุฉ
    sample_map = result.pop("overflow_to_sample_mapping")
    for key, values in examples.items():
        result[key] = [values[i] for i in sample_map]
    return result
```

ูููููุง ุฃู ูุฑู ุฃููุง ุชุนูู ูุน `Dataset.map()` ุจุฏูู ุฃู ูุญุชุงุฌ ุฅูู ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ุงููุฏููุฉ:

```py
tokenized_dataset = drug_dataset.map(tokenize_and_split, batched=True)
tokenized_dataset
```python
out
DatasetDict({
    train: Dataset({
        features: ['attention_mask', 'condition', 'date', 'drugName', 'input_ids', 'patient_id', 'rating', 'review', 'review_length', 'token_type_ids', 'usefulCount'],
        num_rows: 206772
    })
    test: Dataset({
        features: ['attention_mask', 'condition', 'date', 'drugName', 'input_ids', 'patient_id', 'rating', 'review', 'review_length', 'token_type_ids', 'usefulCount'],
        num_rows: 68876
    })
})
```

ูุญุตู ุนูู ููุณ ุนุฏุฏ ููุฒุงุช ุงูุชุฏุฑูุจ ููุง ูู ุงูุณุงุจูุ ูููู ููุง ุงุญุชูุธูุง ุจุฌููุน ุงูุญููู ุงููุฏููุฉ. ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูููุง ูุจุนุถ ุงููุนุงูุฌุฉ ุจุนุฏ ุชุทุจูู ูููุฐุฌูุ ููุฏ ุชุฑุบุจ ูู ุงุณุชุฎุฏุงู ูุฐุง ุงูููุฌ.

ููุฏ ุฑุฃูุช ุงูุขู ููู ูููู ุงุณุชุฎุฏุงู ๐ค Datasets ููุนุงูุฌุฉ ูุฌููุนุฉ ุจูุงูุงุช ุจุทุฑู ูุฎุชููุฉ. ุนูู ุงูุฑุบู ูู ุฃู ูุธุงุฆู ุงููุนุงูุฌุฉ ูู ๐ค Datasets ุณุชุบุทู ูุนุธู ุงุญุชูุงุฌุงุช ุชุฏุฑูุจ ุงููููุฐุฌ ูุฏููุ
ูุฏ ุชููู ููุงู ุฃููุงุช ุชุญุชุงุฌ ูููุง ุฅูู ุงูุชุจุฏูู ุฅูู Pandas ูููุตูู ุฅูู ููุฒุงุช ุฃูุซุฑ ููุฉุ ูุซู `DataFrame.groupby()` ุฃู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุนุงููุฉ ุงููุณุชูู ููุชุตูุฑ. ูุญุณู ุงูุญุธุ ุชู ุชุตููู ๐ค Datasets ููููู ูุชูุงูููุง ูุน ููุชุจุงุช ูุซู Pandas ูNumPy ูPyTorch ูTensorFlow ูJAX. ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุนูู ุฐูู.

## ูู `Dataset`s ุฅูู `DataFrame`s ูุงูุนูุฏุฉ [[from-datasets-to-dataframes-and-back]]

<Youtube id="tfcY1067A5Q"/>

ูุชุณููู ุงูุชุญููู ุจูู ูุฎุชูู ุงูููุชุจุงุช ุงูุฎุงุฑุฌูุฉุ ูููุฑ ๐ค Datasets ูุธููุฉ `Dataset.set_format()`. ุชููู ูุฐู ุงููุธููุฉ ุจุชุบููุฑ _ุชูุณูู ุงูุฅุฎุฑุงุฌ_ ููุฌููุนุฉ ุงูุจูุงูุงุช ููุทุ ูุฐูู ููููู ุงูุชุจุฏูู ุจุณูููุฉ ุฅูู ุชูุณูู ุขุฎุฑ ุฏูู ุงูุชุฃุซูุฑ ุนูู _ุชูุณูู ุงูุจูุงูุงุช_ ุงูุฃุณุงุณูุ ูุงูุฐู ูู Apache Arrow. ูุชู ุงูุชูุณูู ูู ุงูููุงู. ููุชูุถูุญุ ุฏุนูุง ูุญูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุฅูู Pandas:

```py
drug_dataset.set_format("pandas")
```

ุงูุขู ุนูุฏูุง ูููู ุจุงููุตูู ุฅูู ุนูุงุตุฑ ูุฌููุนุฉ ุงูุจูุงูุงุชุ ูุญุตู ุนูู `pandas.DataFrame` ุจุฏูุงู ูู ูุงููุณ:

```py
drug_dataset["train"][:3]
```

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>drugName</th>
      <th>condition</th>
      <th>review</th>
      <th>rating</th>
      <th>date</th>
      <th>usefulCount</th>
      <th>review_length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>95260</td>
      <td>Guanfacine</td>
      <td>adhd</td>
      <td>"My son is halfway through his fourth week of Intuniv..."</td>
      <td>8.0</td>
      <td>April 27, 2010</td>
      <td>192</td>
      <td>141</td>
    </tr>
    <tr>
      <th>1</th>
      <td>92703</td>
      <td>Lybrel</td>
      <td>birth control</td>
      <td>"I used to take another oral contraceptive, which had 21 pill cycle, and was very happy- very light periods, max 5 days, no other side effects..."</td>
      <td>5.0</td>
      <td>December 14, 2009</td>
      <td>17</td>
      <td>134</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138000</td>
      <td>Ortho Evra</td>
      <td>birth control</td>
      <td>"This is my first time using any form of birth control..."</td>
      <td>8.0</td>
      <td>November 3, 2015</td>
      <td>10</td>
      <td>89</td>
    </tr>
  </tbody>
</table>

ุฏุนูุง ููุดุฆ `pandas.DataFrame` ููุฌููุนุฉ ุงูุชุฏุฑูุจ ุจุงููุงูู ุนู ุทุฑูู ุชุญุฏูุฏ ุฌููุน ุนูุงุตุฑ `drug_dataset["train"]`:

```py
train_df = drug_dataset["train"][:]
```

<Tip>

๐จ ุชุญุช ุงูุบุทุงุกุ ุชุบูุฑ ูุธููุฉ `Dataset.set_format()` ุชูุณูู ุงูุฅุฑุฌุงุน ููุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจุฃุณููุจ `__getitem__()` dunder. ูุฐุง ูุนูู ุฃูู ุนูุฏูุง ูุฑูุฏ ุฅูุดุงุก ูุงุฆู ุฌุฏูุฏ ูุซู `train_df` ูู `Dataset` ุจุชูุณูู `"pandas"`ุ ูุญุชุงุฌ ุฅูู ุชูุณูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุงููุงูู ููุญุตูู ุนูู `pandas.DataFrame`. ููููู ุงูุชุญูู ุจููุณู ูู ุฃู ููุน `drug_dataset["train"]` ูู `Dataset`ุ ุจุบุถ ุงููุธุฑ ุนู ุชูุณูู ุงูุฅุฎุฑุงุฌ.

</Tip>


ูู ููุง ูููููุง ุงุณุชุฎุฏุงู ุฌููุน ูุธุงุฆู Pandas ุงูุชู ูุฑูุฏ. ุนูู ุณุจูู ุงููุซุงูุ ูููููุง ุงูููุงู ุจุณูุณูุฉ ุฑุงุฆุนุฉ ูุญุณุงุจ ุชูุฒูุน ุงููุฆุงุช ุจูู ุฅุฏุฎุงูุงุช `condition`:

```py
frequencies = (
    train_df["condition"]
    .value_counts()
    .to_frame()
    .reset_index()
    .rename(columns={"index": "condition", "condition": "frequency"})
)
frequencies.head()
```

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>condition</th>
      <th>frequency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>birth control</td>
      <td>27655</td>
    </tr>
    <tr>
      <th>1</th>
      <td>depression</td>
      <td>8023</td>
    </tr>
    <tr>
      <th>2</th>
      <td>acne</td>
      <td>5209</td>
    </tr>
    <tr>
      <th>3</th>
      <td>anxiety</td>
      <td>4991</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pain</td>
      <td>4744</td>
    </tr>
  </tbody>
</table>


ูุจูุฌุฑุฏ ุงูุงูุชูุงุก ูู ุชุญููู Pandasุ ูููููุง ุฏุงุฆููุง ุฅูุดุงุก ูุงุฆู `Dataset` ุฌุฏูุฏ ุจุงุณุชุฎุฏุงู ูุธููุฉ `Dataset.from_pandas()` ููุง ููู:


```py
from datasets import Dataset

freq_dataset = Dataset.from_pandas(frequencies)
freq_dataset
```

```python out
Dataset({
    features: ['condition', 'frequency'],
    num_rows: 819
})
```

<Tip>

โ๏ธ **ุฌุฑุจู!** ุงุญุณุจ ูุชูุณุท ุงูุชูููู ููู ุฏูุงุก ูุงุญูุธ ุงููุชูุฌุฉ ูู `Dataset` ุฌุฏูุฏ.

</Tip>

ูุฐุง ููุฎุต ุฌููุชูุง ูู ุชูููุงุช ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ุงููุฎุชููุฉ ุงููุชุงุญุฉ ูู ๐ค Datasets. ูุฅููุงุก ุงููุณูุ ุฏุนูุง ููุดุฆ ูุฌููุนุฉ ุจูุงูุงุช ููุชุญูู ูู ุงูุตุญุฉ ูุฅุนุฏุงุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุชุฏุฑูุจ ูุตูู ุนูููุง. ูุจู ุงูููุงู ุจุฐููุ ุณูุนูุฏ ุชุนููู ุชูุณูู ุงูุฅุฎุฑุงุฌ ูู `drug_dataset` ูู `"pandas"` ุฅูู `"arrow"`:

```python
drug_dataset.reset_format()
```

## ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ููุชุญูู ูู ุงูุตุญุฉ [[creating-a-validation-set]]

ุนูู ุงูุฑุบู ูู ุฃู ูุฏููุง ูุฌููุนุฉ ุงุฎุชุจุงุฑ ูููููุง ุงุณุชุฎุฏุงููุง ููุชููููุ ุฅูุง ุฃูู ูู ุงูุฌูุฏ ุชุฑู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ ุฏูู ุชุบููุฑ ูุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ูููุตูุฉ ููุชุญูู ูู ุงูุตุญุฉ ุฃุซูุงุก ุงูุชุทููุฑ. ุจูุฌุฑุฏ ุฃู ุชููู ุฑุงุถููุง ุนู ุฃุฏุงุก ููุงุฐุฌู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉุ ููููู ุฅุฌุฑุงุก ูุญุต ููุงุฆู ุนูู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ. ุชุณุงุนุฏ ูุฐู ุงูุนูููุฉ ูู ุงูุชุฎููู ูู ุฎุทุฑ ุงูุฅูุฑุงุท ูู ููุงุกูุฉ ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ ููุดุฑ ูููุฐุฌ ููุดู ูู ุจูุงูุงุช ุงูุนุงูู ุงูุญูููู.

ูููุฑ ๐ค Datasets ูุธููุฉ `Dataset.train_test_split()` ุงูุชู ุชุณุชูุฏ ุฅูู ุงููุธููุฉ ุงูุดููุฑุฉ ูู `scikit-learn`. ุฏุนูุง ูุณุชุฎุฏููุง ูุชูุณูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจูุง ุฅูู ุฃูุณุงู `train` ู`validation` (ูุญุฏุฏ ุญุฌุฉ `seed` ููุชูุฑุงุฑ):

```py
drug_dataset_clean = drug_dataset["train"].train_test_split(train_size=0.8, seed=42)
# ุฅุนุงุฏุฉ ุชุณููุฉ ุงูุชูุณูู ุงูุงูุชุฑุงุถู "test" ุฅูู "validation"
drug_dataset_clean["validation"] = drug_dataset_clean.pop("test")
# ุฅุถุงูุฉ ูุฌููุนุฉ "test" ุฅูู `DatasetDict` ุงูุฎุงุตุฉ ุจูุง
drug_dataset_clean["test"] = drug_dataset["test"]
drug_dataset_clean
```

```python out
DatasetDict({
    train: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length', 'review_clean'],
        num_rows: 110811
    })
    validation: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length', 'review_clean'],
        num_rows: 27703
    })
    test: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length', 'review_clean'],
        num_rows: 46108
    })
})
```

ุฑุงุฆุนุ ููุฏ ุฃุนุฏุฏูุง ุงูุขู ูุฌููุนุฉ ุจูุงูุงุช ุฌุงูุฒุฉ ูุชุฏุฑูุจ ุจุนุถ ุงูููุงุฐุฌ ุนูููุง! ูู [ุงููุณู 5](/course/chapter5/5) ุณูุฑููู ููููุฉ ุชุญููู ูุฌููุนุงุช ุงูุจูุงูุงุช ุฅูู Hugging Face Hubุ ูููู ุงูุขู ุฏุนูุง ูููู ุชุญููููุง ุจุงููุธุฑ ุฅูู ุจุนุถ ุงูุทุฑู ุงูุชู ููููู ูู ุฎูุงููุง ุญูุธ ูุฌููุนุงุช ุงูุจูุงูุงุช ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงููุญูู ุงูุฎุงุต ุจู.

## ุญูุธ ูุฌููุนุฉ ุจูุงูุงุช [[saving-a-dataset]]

<Youtube id="blF9uxYcKHo"/>

ุนูู ุงูุฑุบู ูู ุฃู ๐ค Datasets ุณุชููู ุจุชุฎุฒูู ูู ูุฌููุนุฉ ุจูุงูุงุช ุชู ุชูุฒูููุง ูุงูุนูููุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุนูููุงุ ุฅูุง ุฃูู ูุฏ ุชููู ููุงู ุฃููุงุช ุชุฑุบุจ ูููุง ูู ุญูุธ ูุฌููุนุฉ ุจูุงูุงุช ุนูู ุงููุฑุต (ุนูู ุณุจูู ุงููุซุงูุ ูู ุญุงูุฉ ุญุฐู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช). ููุง ูู ููุถุญ ูู ุงูุฌุฏูู ุฃุฏูุงูุ ูููุฑ ๐ค Datasets ุซูุงุซ ูุธุงุฆู ุฑุฆูุณูุฉ ูุญูุธ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู ุจุชูุณููุงุช ูุฎุชููุฉ:

| ุชูุณูู ุงูุจูุงูุงุช |        ุงููุธููุฉ        |
| :---------: | :--------------------: |
|    Arrow    | `Dataset.save_to_disk()` |
|     CSV     |    `Dataset.to_csv()`    |
|    JSON     |   `Dataset.to_json()`    |

ุนูู ุณุจูู ุงููุซุงูุ ุฏุนูุง ูุญูุธ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุธููุฉ ุงูุฎุงุตุฉ ุจูุง ุจุชูุณูู Arrow:

```py
drug_dataset_clean.save_to_disk("drug-reviews")
```

ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ุฏููู ุจุงููููู ุงูุชุงูู:
ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ุฏููู ุจุงููููู ุงูุชุงูู:

```
drug-reviews/
โโโ dataset_dict.json
โโโ test
โ   โโโ dataset.arrow
โ   โโโ dataset_info.json
โ   โโโ state.json
โโโ train
โ   โโโ dataset.arrow
โ   โโโ dataset_info.json
โ   โโโ indices.arrow
โ   โโโ state.json
โโโ validation
    โโโ dataset.arrow
    โโโ dataset_info.json
    โโโ indices.arrow
    โโโ state.json
```

ุญูุซ ูููููุง ุฃู ูุฑู ุฃู ูู ูุณู ูุฑุชุจุท ุจุฌุฏูู *dataset.arrow* ุงูุฎุงุต ุจูุ ูุจุนุถ ุงูุจูุงูุงุช ุงููุตููุฉ ูู *dataset_info.json* ู *state.json*. ููููู ุงุนุชุจุงุฑ ุชูุณูู Arrow ูุฌุฏูู ุฃููู ูู ุงูุฃุนูุฏุฉ ูุงูุตูููุ ููู ููุญุณูู ูุจูุงุก ุชุทุจููุงุช ุนุงููุฉ ุงูุฃุฏุงุก ุชูุนุงูุฌ ูุชููู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงููุจูุฑุฉ.

ุจูุฌุฑุฏ ุญูุธ ูุฌููุนุฉ ุงูุจูุงูุงุชุ ูููููุง ุชุญููููุง ุจุงุณุชุฎุฏุงู ุฏุงูุฉ `load_from_disk()` ููุง ููู:

```py
from datasets import load_from_disk

drug_dataset_reloaded = load_from_disk("drug-reviews")
drug_dataset_reloaded
```

```python out
DatasetDict({
    train: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length'],
        num_rows: 110811
    })
    validation: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length'],
        num_rows: 27703
    })
    test: Dataset({
        features: ['patient_id', 'drugName', 'condition', 'review', 'rating', 'date', 'usefulCount', 'review_length'],
        num_rows: 46108
    })
})
```

ุจุงููุณุจุฉ ูุชูุณููุงุช CSV ูJSONุ ูุฌุจ ุนูููุง ุชุฎุฒูู ูู ูุณู ูููู ูููุตู. ุฅุญุฏู ุงูุทุฑู ููููุงู ุจุฐูู ูู ุงูุชูุฑุงุฑ ุนุจุฑ ุงูููุงุชูุญ ูุงูููู ูู ูุงุฆู `DatasetDict`:

```py
for split, dataset in drug_dataset_clean.items():
    dataset.to_json(f"drug-reviews-{split}.jsonl")
```

ูุฐุง ูุญูุธ ูู ูุณู ูู [ุชูุณูู JSON Lines](https://jsonlines.org)ุ ุญูุซ ูุชู ุชุฎุฒูู ูู ุตู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุณุทุฑ ูุงุญุฏ ูู JSON. ุฅููู ููู ูุจุฏู ุงููุซุงู ุงูุฃูู:

```py
!head -n 1 drug-reviews-train.jsonl
```

```python out
{"patient_id":141780,"drugName":"Escitalopram","condition":"depression","review":"\"I seemed to experience the regular side effects of LEXAPRO, insomnia, low sex drive, sleepiness during the day. I am taking it at night because my doctor said if it made me tired to take it at night. I assumed it would and started out taking it at night. Strange dreams, some pleasant. I was diagnosed with fibromyalgia. Seems to be helping with the pain. Have had anxiety and depression in my family, and have tried quite a few other medications that haven't worked. Only have been on it for two weeks but feel more positive in my mind, want to accomplish more in my life. Hopefully the side effects will dwindle away, worth it to stick with it from hearing others responses. Great medication.\"","rating":9.0,"date":"May 29, 2011","usefulCount":10,"review_length":125}
```

ุจุนุฏ ุฐููุ ูููููุง ุงุณุชุฎุฏุงู ุงูุชูููุงุช ูู [ุงููุณู 2](/course/chapter5/2) ูุชุญููู ูููุงุช JSON ููุง ููู:

```py
data_files = {
    "train": "drug-reviews-train.jsonl",
    "validation": "drug-reviews-validation.jsonl",
    "test": "drug-reviews-test.jsonl",
}
drug_dataset_reloaded = load_dataset("json", data_files=data_files)
```

ููุฐุง ูู ุดูุก ูู ุฑุญูุชูุง ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ๐ค Datasets! ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ูุฌููุนุฉ ุจูุงูุงุช ูุธููุฉ ููุชุฏุฑูุจ ุนูู ูููุฐุฌุ ุฅููู ุจุนุถ ุงูุฃููุงุฑ ุงูุชู ููููู ุชุฌุฑุจุชูุง:

1. ุงุณุชุฎุฏู ุงูุชูููุงุช ูู [ุงููุตู 3](/course/chapter3) ูุชุฏุฑูุจ ูุตูู ููููู ุงูุชูุจุค ุจุญุงูุฉ ุงููุฑูุถ ุจูุงุกู ุนูู ูุฑุงุฌุนุฉ ุงูุฏูุงุก.
2. ุงุณุชุฎุฏู ุฎุท ุฃูุงุจูุจ `summarization` ูู [ุงููุตู 1](/course/chapter1) ูุชูููุฏ ููุฎุตุงุช ูููุฑุงุฌุนุงุช.

ุจุนุฏ ุฐููุ ุณูููู ูุธุฑุฉ ุนูู ููููุฉ ุชูููู ๐ค Datasets ูู ูู ุงูุนูู ูุน ูุฌููุนุงุช ุจูุงูุงุช ุถุฎูุฉ ุฏูู ุชุนุทูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงููุญููู ุงูุฎุงุต ุจู!