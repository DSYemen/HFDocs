# ุงูุถุจุท ุงูููู 

ุงูุถุจุท ุงูููู ูู ุชูููุฉ ูุฎูุถ ุงูุชูุงููู ุงูุญุณุงุจูุฉ ูุชูุงููู ุงูุฐุงูุฑุฉ ูุชุดุบูู ุงูุงุณุชุฏูุงู ุนู ุทุฑูู ุชูุซูู ุงูุฃูุฒุงู ูุงูุชูุดูุทุงุช ุจุฃููุงุน ุจูุงูุงุช ููุฎูุถุฉ ุงูุฏูุฉ ูุซู 8 ุจุช ุตุญูุญ (`int8`) ุจุฏูุงู ูู 32 ุจุช ุนุงุฆู (`float32`) ุงููุนุชุงุฏุฉ.

ุฅู ุชูููู ุนุฏุฏ ุงูุจุชุงุช ูุนูู ุฃู ุงููููุฐุฌ ุงููุงุชุฌ ูุชุทูุจ ูุณุงุญุฉ ุชุฎุฒูู ุฃูู ูู ุงูุฐุงูุฑุฉุ ููุณุชููู ุทุงูุฉ ุฃูู (ูุธุฑููุง)ุ ููููู ุฅุฌุฑุงุก ุนูููุงุช ูุซู ุงูุถุฑุจ ูู ุงููุตูููุฉ ุจุดูู ุฃุณุฑุน ุจูุซูุฑ ุจุงุณุชุฎุฏุงู ุงูุญุณุงุจ ุงูุตุญูุญ. ููุง ูุณูุญ ุจุชุดุบูู ุงูููุงุฐุฌ ุนูู ุงูุฃุฌูุฒุฉ ุงููุฏูุฌุฉุ ูุงูุชู ุชุฏุนู ูู ุจุนุถ ุงูุฃุญูุงู ุฃููุงุน ุจูุงูุงุช ุตุญูุญุฉ ููุท.

## ุงููุธุฑูุฉ

ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ ูุฑุงุก ุงูุถุจุท ุงูููู ุจุณูุทุฉ ููุบุงูุฉ: ุงูุงูุชูุงู ูู ุชูุซูู ุนุงูู ุงูุฏูุฉ (ุนุงุฏุฉ 32 ุจุช ุนุงุฆู ุนุงุฏู) ููุฃูุฒุงู ูุงูุชูุดูุทุงุช ุฅูู ููุน ุจูุงูุงุช ุฃูู ุฏูุฉ. ูุฃููุงุน ุงูุจูุงูุงุช ุงูุฃูู ุฏูุฉ ุงูุดุงุฆุนุฉ ูู:

- `float16`ุ ููุน ุจูุงูุงุช ุงูุชุฑุงูู `float16`
- `bfloat16`ุ ููุน ุจูุงูุงุช ุงูุชุฑุงูู `float32`
- `int16`ุ ููุน ุจูุงูุงุช ุงูุชุฑุงูู `int32`
- `int8`ุ ููุน ุจูุงูุงุช ุงูุชุฑุงูู `int32`

ูุญุฏุฏ ููุน ุจูุงูุงุช ุงูุชุฑุงูู ููุน ูุชูุฌุฉ ุชุฑุงูู (ุฅุถุงูุฉ ุฃู ุถุฑุจุ ููุง ุฅูู ุฐูู) ุงูููู ูู ููุน ุงูุจูุงูุงุช ุงููุนูู. ุนูู ุณุจูู ุงููุซุงูุ ููุฃุฎุฐ ูููุชูู `int8` `A = 127`ุ `B = 127`ุ ูููุญุฏุฏ `C` ุนูู ุฃูู ูุฌููุน `A` ู`B`:

```
C = A + B
```

ููุงุ ุงููุชูุฌุฉ ุฃูุจุฑ ุจูุซูุฑ ูู ุฃูุจุฑ ูููุฉ ูููู ุชูุซูููุง ูู `int8`ุ ูุงูุชู ูู `127`. ููู ููุง ุชุฃุชู ุงูุญุงุฌุฉ ุฅูู ููุน ุจูุงูุงุช ุฃูุจุฑ ุฏูุฉ ูุชุฌูุจ ููุฏุงู ุงูุฏูุฉ ุงููุงุฆู ุงูุฐู ูู ุดุฃูู ุฃู ูุฌุนู ุนูููุฉ ุงูุถุจุท ุงูููู ุจุฃููููุง ุนุฏููุฉ ุงููุงุฆุฏุฉ.

## ุงูุถุจุท ุงูููู

ุญุงูุชุง ุงูุถุจุท ุงูููู ุงูุฃูุซุฑ ุดููุนูุง ููุง `float32 -> float16` ู`float32 -> int8`.

### ุงูุถุจุท ุงูููู ุฅูู `float16`

ุฅู ุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ููุงูุชูุงู ูู `float32` ุฅูู `float16` ุฃูุฑ ูุจุงุดุฑ ุฅูู ุญุฏ ูุง ูุฃู ููุง ููุนู ุงูุจูุงูุงุช ูุชุจุนุงู ููุณ ูุธุงู ุงูุชูุซูู. ูุงูุฃุณุฆูุฉ ุงูุชู ูุฌุจ ุฃู ุชุทุฑุญูุง ุนูู ููุณู ุนูุฏ ุถุจุท ุนูููุฉ ุฅูู `float16` ูู:

- ูู ููุฌุฏ ุชูููุฐ `float16` ูุนูููุฉุ
- ูู ูุฏุนู ุนุชุงุฏู `float16`ุ ุนูู ุณุจูู ุงููุซุงูุ ูุงูุช ูุนุงูุฌุงุช Intel ุชุฏุนู `float16` ูููุน ุชุฎุฒููุ ูููู ูุชู ุฅุฌุฑุงุก ุงูุญุณุงุจ ุจุนุฏ ุงูุชุญููู ุฅูู `float32`. ุณูุฃุชู ุงูุฏุนู ุงููุงูู ูู Cooper Lake ูSapphire Rapids.
- ูู ุนูููุฉ ุญุณุงุณุฉ ููุฏูุฉ ุงูููุฎูุถุฉุ

ุนูู ุณุจูู ุงููุซุงูุ ุชููู ูููุฉ epsilon ูู `LayerNorm` ุนุงุฏุฉ ุตุบูุฑุฉ ุฌุฏูุง (~ `1e-12`)ุ ูููู ุฃุตุบุฑ ูููุฉ ูููู ุชูุซูููุง ูู `float16` ูู ~ `6e-5`ุ ููููู ุฃู ูุชุณุจุจ ุฐูู ูู ูุดููุงุช `NaN`. ูููุทุจู ุงูุดูุก ููุณู ุนูู ุงูููู ุงููุจูุฑุฉ.

### ุงูุถุจุท ุงูููู ุฅูู `int8`

ุฅู ุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ููุงูุชูุงู ูู `float32` ุฅูู `int8` ุฃูุซุฑ ุชุนููุฏูุง. ูููู ุชูุซูู 256 ูููุฉ ููุท ูู `int8`ุ ูู ุญูู ุฃู `float32` ูููู ุฃู ููุซู ูุทุงููุง ูุงุณุนูุง ุฌุฏูุง ูู ุงูููู. ูุงูููุฑุฉ ูู ุฅูุฌุงุฏ ุฃูุถู ุทุฑููุฉ ููุดุฑูุน ูุทุงููุง `[aุ b]` ูู ููู `float32` ุฅูู ูุณุงุญุฉ `int8`.

ููุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุนุฏุฏูุง ุนุงุฆููุง `x` ูู `[aุ b]`ุ ุฅุฐู ูููููุง ูุชุงุจุฉ ูุฎุทุท ุงูุถุจุท ุงูููู ุงูุชุงููุ ูุงูุฐู ููุทูู ุนููู ุฃูุถูุง ูุฎุทุท ุงูุถุจุท ุงูููู *ุงูุฎุทู*:

```
x = S * (x_q - Z)
```

ุญูุซ:

- `x_q` ูู ุงููููุฉ ุงููุถุจูุทุฉ `int8` ุงูููุชุฑูุฉ ุจู `x`
- `S` ู`Z` ููุง ูุนุงููุง ุงูุถุจุท ุงูููู
- `S` ูู ุงููููุงุณุ ููู ุนุฏุฏ ููุฌุจ `float32`
- `Z` ููุณูู ููุทุฉ ุงูุตูุฑุ ููู ูููุฉ `int8` ุงูููุงุจูุฉ ูููููุฉ `0` ูู ูุฌุงู `float32`. ูุฐุง ุฃูุฑ ููู ูุชูุซูู ุงููููุฉ `0` ุจุฏูุฉ ูุฃููุง ุชุณุชุฎุฏู ูู ูู ููุงู ูู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู.

ูููู ุญุณุงุจ ุงููููุฉ ุงููุถุจูุทุฉ `x_q` ูู `x` ูู `[aุ b]` ุนูู ุงููุญู ุงูุชุงูู:

```
x_q = round(x/S + Z)
```

ูุชุชู ุชูููู ููู `float32` ุฎุงุฑุฌ ุงููุทุงู `[aุ b]` ุฅูู ุฃูุฑุจ ูููุฉ ูููู ุชูุซูููุงุ ูุฐุง ูุฃู ุฑูู ุนุดุฑู `x`:

```
x_q = clip(round(x/S + Z), round(a/S + Z), round(b/S + Z))
```

<Tip>
ุนุงุฏุฉู ูุง ููุงุจู `round(a/S + Z)` ุฃุตุบุฑ ูููุฉ ูููู ุชูุซูููุง ูู ููุน ุงูุจูุงูุงุช ููุฏ ุงููุธุฑุ ู`round(b/S + Z)` ูุฃูุจุฑ ูููุฉ. ูููู ูููู ุฃู ูุฎุชูู ูุฐุงุ ุนูู ุณุจูู ุงููุซุงู ุนูุฏ ุงุณุชุฎุฏุงู ูุฎุทุท ุงูุถุจุท ุงูููู *ุงููุชูุงุซู* ููุง ุณุชุฑู ูู ุงูููุฑุฉ ุงูุชุงููุฉ.
</Tip>

### ูุฎุทุทุงุช ุงูุถุจุท ุงูููู ุงููุชูุงุซูุฉ ูุงูุฎุทูุฉ

ุชุณูู ุงููุนุงุฏูุฉ ุฃุนูุงู ุจูุฎุทุท ุงูุถุจุท ุงูููู *ุงูุฎุทู* ูุฃู ุงูุฎุฑูุทุฉ ูู `[aุ b]` ุฅูู `int8` ูู ุฎุฑูุทุฉ ุฎุทูุฉ.

ุญุงูุฉ ุฎุงุตุฉ ุดุงุฆุนุฉ ูู ูุฐุง ุงููุฎุทุท ูู ูุฎุทุท ุงูุถุจุท ุงูููู *ุงููุชูุงุซู*ุ ุญูุซ ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ูุทุงููุง ูุชูุงุซููุง ููููู ุงูุนุงุฆูุฉ `[-aุ a]`.

ูู ูุฐู ุงูุญุงูุฉุ ูููู ูุทุงู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุนุงุฏุฉู `[-127ุ 127]`ุ ููุง ูุนูู ุฃูู ูุชู ุงุณุชุจุนุงุฏ `-128` ูู ูุทุงู `int8` ุงูููููุน ุงูุนุงุฏู `[โ128ุ 127]`. ูุงูุณุจุจ ูู ุฐูู ูู ุฃู ูุฌูุฏ ููุง ุงููุทุงููู ูุชูุงุซููู ูุณูุญ ุจุฃู ูููู `Z = 0`. ูู ุญูู ูุชู ููุฏุงู ุฅุญุฏู ุงูููู ูู ุจูู 256 ูููุฉ ูููู ุชูุซูููุงุ ูููู ุฃู ูููุฑ ุฐูู ุชุณุฑูุนูุง ูุฃู ุงูุนุฏูุฏ ูู ุนูููุงุช ุงูุฌูุน ูููู ุชุฎุทููุง.

**ููุงุญุธุฉ**: ููุนุฑูุฉ ููููุฉ ุญุณุงุจ ูุนุงููุงุช ุงูุถุจุท ุงูููู `S` ู`Z`ุ ููููู ูุฑุงุกุฉ ูุฑูุฉ "ุถุจุท ูุชุฏุฑูุจ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ููุชุญููู ุงููุนุงู ูุงุณุชูุชุงุฌ ุงูุญุณุงุจ ุงูุตุญูุญ ููุท" [Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference](https://arxiv.org/abs/1712.05877) ุฃู ุชุฏูููุฉ Lei Mao [Lei Mao's blog post](https://leimao.github.io/article/Neural-Networks-Quantization) ุญูู ูุฐุง ุงูููุถูุน.

### ุงูุถุจุท ุงูููู ููู ููุชุฑ ููู ููุงุฉ

ุงุนุชูุงุฏูุง ุนูู ุงูุชูุงุฒู ุจูู ุงูุฏูุฉ ูุงูุชุฃุฎูุฑ ุงูุฐู ุชุณุชูุฏููุ ููููู ุงููุนุจ ุจุฏูุฉ ูุนุงููุงุช ุงูุถุจุท ุงูููู:

- ูููู ุญุณุงุจ ูุนุงููุงุช ุงูุถุจุท ุงูููู ุนูู ุฃุณุงุณ *ูู ููุชุฑ*ุ ููุง ูุนูู ุฃูู ุณูุชู ุงุณุชุฎุฏุงู ุฒูุฌ ูุงุญุฏ ูู `(Sุ Z)` ููู ููุชุฑ.
- ูููู ุญุณุงุจ ูุนุงููุงุช ุงูุถุจุท ุงูููู ุนูู ุฃุณุงุณ *ูู ููุงุฉ*ุ ููุง ูุนูู ุฃูู ูู ุงููููู ุชุฎุฒูู ุฒูุฌ ูุงุญุฏ ูู `(Sุ Z)` ููู ุนูุตุฑ ุนูู ุทูู ุฃุญุฏ ุฃุจุนุงุฏ ุงูููุชุฑ. ุนูู ุณุจูู ุงููุซุงูุ ุจุงููุณุจุฉ ูููุชุฑ ุงูุดูู `[Nุ Cุ Hุ W]`ุ ูุฅู ูุฌูุฏ ูุนุงููุงุช ุถุจุท ููู ููู ููุงุฉ ููุจุนุฏ ุงูุซุงูู ุณููุชุฌ ุนูู ูุฌูุฏ `C` ุฃุฒูุงุฌ ูู `(Sุ Z)`. ูู ุญูู ุฃู ูุฐุง ูููู ุฃู ูุนุทู ุฏูุฉ ุฃูุถูุ ูุฅูู ูุชุทูุจ ุฐุงูุฑุฉ ุฃูุจุฑ.

### ุงููุนุงูุฑุฉ

ูุตู ุงููุณู ุฃุนูุงู ููููุฉ ุนูู ุงูุถุจุท ุงูููู ูู `float32` ุฅูู `int8`ุ ูููู ูุจูู ุณุคุงู ูุงุญุฏ: ููู ูุชู ุชุญุฏูุฏ ูุทุงู `[aุ b]` ูู ููู `float32`ุ ูุฐุง ูู ุงูููุงู ุงูุฐู ุชุฃุชู ููู ุงููุนุงูุฑุฉ.

ุงููุนุงูุฑุฉ ูู ุงูุฎุทูุฉ ุฃุซูุงุก ุงูุถุจุท ุงูููู ุงูุชู ูุชู ูููุง ุญุณุงุจ ูุทุงูุงุช `float32`. ุจุงููุณุจุฉ ููุฃูุฒุงูุ ููู ุณููุฉ ุฅูู ุญุฏ ูุง ูุฃู ุงููุทุงู ุงููุนูู ูุนุฑูู ูู *ููุช ุงูุถุจุท ุงูููู*. ูููู ุงูุฃูุฑ ุฃูู ูุถูุญูุง ุจุงููุณุจุฉ ููุชูุดูุทุงุชุ ูููุงู ููุฌ ูุฎุชููุฉ:

1. ุงูุถุจุท ุงูููู ุงูุฏููุงูููู ุจุนุฏ ุงูุชุฏุฑูุจ: ูุชู ุญุณุงุจ ุงููุทุงู ููู ุชูุดูุท ุฃุซูุงุก ุงูุชููู ูู *ููุช ุงูุชุดุบูู*. ูู ุญูู ุฃู ูุฐุง ูุนุทู ูุชุงุฆุฌ ุฑุงุฆุนุฉ ุฏูู ุงููุซูุฑ ูู ุงูุนููุ ููุฏ ูููู ุฃุจุทุฃ ููููุงู ูู ุงูุถุจุท ุงูููู ุงูุซุงุจุช ุจุณุจุจ ุงูุนุจุก ุงูุฒุงุฆุฏ ุงูุฐู ุชูุฑุถู ุนูููุฉ ุญุณุงุจ ุงููุทุงู ูู ูู ูุฑุฉ. ููุง ุฃูู ููุณ ุฎูุงุฑูุง ุนูู ุฃุฌูุฒุฉ ูุนููุฉ.
2. ุงูุถุจุท ุงูููู ุงูุซุงุจุช ุจุนุฏ ุงูุชุฏุฑูุจ: ูุชู ุญุณุงุจ ุงููุทุงู ููู ุชูุดูุท ูุณุจููุง ูู *ููุช ุงูุถุจุท ุงูููู*ุ ุนุงุฏุฉู ุนู ุทุฑูู ุชูุฑูุฑ ุงูุจูุงูุงุช ุงูุชูุซูููุฉ ุนุจุฑ ุงููููุฐุฌ ูุชุณุฌูู ููู ุงูุชูุดูุท. ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉุ ุงูุฎุทูุงุช ูู:
    1. ูุชู ูุถุน ุงููุฑุงูุจูู ุนูู ุงูุชูุดูุทุงุช ูุชุณุฌูู ููููุง.
    2. ูุชู ุฅุฌุฑุงุก ุนุฏุฏ ูุนูู ูู ุนูููุงุช ุงูุชุบุฐูุฉ ุงูุฃูุงููุฉ ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงููุนุงูุฑุฉ (ุญูุงูู 200 ูุซุงู ูุงูู).
    3. ูุชู ุญุณุงุจ ุงููุทุงูุงุช ููู ุนูููุฉ ุญุณุงุจูุฉ ููููุง ูุจุนุถ *ุชูููุงุช ุงููุนุงูุฑุฉ*.
3. ุงูุถุจุท ุงูููู ุฃุซูุงุก ุงูุชุฏุฑูุจ: ูุชู ุญุณุงุจ ุงููุทุงู ููู ุชูุดูุท ูู *ููุช ุงูุชุฏุฑูุจ*ุ ุจุงุชุจุงุน ููุณ ููุฑุฉ ุงูุถุจุท ุงูููู ุงูุซุงุจุช ุจุนุฏ ุงูุชุฏุฑูุจ. ูููู ูุชู ุงุณุชุฎุฏุงู ูุดุบูุงุช "ุงูุถุจุท ุงูููู ุงููุฒูู" ุจุฏูุงู ูู ุงููุฑุงูุจูู: ููู ุชุณุฌู ุงูููู ูุซู ุงููุฑุงูุจููุ ูููููุง ุชุญุงูู ุฃูุถูุง ุงูุฎุทุฃ ุงูุฐู ูุณุจุจู ุงูุถุจุท ุงูููู ููุณูุงุญ ูููููุฐุฌ ุจุงูุชููู ูุนู.

ุจุงููุณุจุฉ ููู ูู ุงูุถุจุท ุงูููู ุงูุซุงุจุช ุจุนุฏ ุงูุชุฏุฑูุจ ูุงูุถุจุท ุงูููู ุฃุซูุงุก ุงูุชุฏุฑูุจุ ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ุชูููุงุช ุงููุนุงูุฑุฉุ ูุงูุฃูุซุฑ ุดููุนูุง ูู:

- ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู: ุงููุทุงู ุงููุญุณูุจ ูู `[ุฃุตุบุฑ ูููุฉ ููุญูุธุฉุ ุฃูุจุฑ ูููุฉ ููุญูุธุฉ]`ุ ููุฐุง ูุนูู ุจุดูู ุฌูุฏ ูุน ุงูุฃูุฒุงู.
- ุงููุชูุณุท ุงููุชุญุฑู ููุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู: ุงููุทุงู ุงููุญุณูุจ ูู `[ูุชูุณุท ูุชุญุฑู ููุญุฏ ุงูุฃุฏูู ูููููุฉ ุงูููุญูุธุฉุ ูุชูุณุท ูุชุญุฑู ููุญุฏ ุงูุฃูุตู ูููููุฉ ุงูููุญูุธุฉ]`ุ ููุฐุง ูุนูู ุจุดูู ุฌูุฏ ูุน ุงูุชูุดูุทุงุช.
- ูุฎุทุท ุจูุงูู: ูุณุฌู ูุฎุทุทูุง ุจูุงูููุง ููููู ุฅูู ุฌุงูุจ ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ูููููุ ุซู ูุฎุชุงุฑ ููููุง ููุนูุงุฑ ูุง:
    - ุฅูุชุฑูุจูุง: ูุชู ุญุณุงุจ ุงููุทุงู ุนูู ุฃูู ุงููุทุงู ุงูุฐู ูููู ุงูุฎุทุฃ ุจูู ุงูุจูุงูุงุช ุฐุงุช ุงูุฏูุฉ ุงููุงููุฉ ูุงูุจูุงูุงุช ุงููุถุจูุทุฉ.
    - ูุชูุณุท โโุงูุฎุทุฃ ุงูุชุฑุจูุนู: ูุชู ุญุณุงุจ ุงููุทุงู ุนูู ุฃูู ุงููุทุงู ุงูุฐู ูููู ูุชูุณุท โโุงูุฎุทุฃ ุงูุชุฑุจูุนู ุจูู ุงูุจูุงูุงุช ุฐุงุช ุงูุฏูุฉ ุงููุงููุฉ ูุงูุจูุงูุงุช ุงููุถุจูุทุฉ.
    - ุงููุฆููู: ูุชู ุญุณุงุจ ุงููุทุงู ุจุงุณุชุฎุฏุงู ูููุฉ ูุฆูููุฉ ูุนููุฉ `p` ุนูู ุงูููู ุงูููุญูุธุฉ. ุงูููุฑุฉ ูู ูุญุงููุฉ ุงูุญุตูู ุนูู `p%` ูู ุงูููู ุงูููุญูุธุฉ ูู ุงููุทุงู ุงููุญุณูุจ. ูู ุญูู ุฃู ูุฐุง ูููู ุนูุฏ ุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ุงูุฎุทูุ ุฅูุง ุฃูู ููุณ ูู ุงููููู ุฏุงุฆููุง ูุทุงุจูุชู ุชูุงููุง ุนูุฏ ุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ุงููุชูุงุซู. ููููู ุงูุชุญูู ูู [ููููุฉ ุงูููุงู ุจุฐูู ูู ONNX Runtime](https://github.com/microsoft/onnxruntime/blob/2cb12caf9317f1ded37f6db125cb03ba99320c40/onnxruntime/python/tools/quantization/calibrate.py#L698) ููุฒูุฏ ูู ุงูุชูุงุตูู.

### ุงูุฎุทูุงุช ุงูุนูููุฉ ูุถุจุท ูููุฐุฌ ุฅูู `int8`

ูุถุจุท ูููุฐุฌ ุจุดูู ูุนุงู ุฅูู `int8`ุ ูุฅู ุงูุฎุทูุงุช ุงูุชู ูุฌุจ ุงุชุจุงุนูุง ูู:

1. ุงุฎุชุฑ ุงููุดุบููู ุงูุฐูู ุณูุชู ุถุจุทูู. ุงููุดุบููู ุงูุฌูุฏูู ููุถุจุท ูู ุงููุดุบููู ุงูุฐูู ููููููู ุนูู ููุช ุงูุญุณุงุจุ ุนูู ุณุจูู ุงููุซุงูุ ุงูุฅุณูุงุทุงุช ุงูุฎุทูุฉ ูุถุฑุจ ุงููุตูููุฉ.
2. ุฌุฑุจ ุงูุถุจุท ุงูููู ุงูุฏููุงูููู ุจุนุฏ ุงูุชุฏุฑูุจุ ุฅุฐุง ูุงู ุณุฑูุนูุง ุจูุง ููููุ ูุชููู ููุงุ ูุฅูุง ูุงูุชูู ุฅูู ุงูุฎุทูุฉ 3.
3. ุฌุฑุจ ุงูุถุจุท ุงูููู ุงูุซุงุจุช ุจุนุฏ ุงูุชุฏุฑูุจ ูุงูุฐู ูููู ุฃู ูููู ุฃุณุฑุน ูู ุงูุถุจุท ุงูููู ุงูุฏููุงูููู ููููู ุบุงูุจูุง ูุง ูููู ูุตุญูุจูุง ุจุงูุฎูุงุถ ูู ุงูุฏูุฉ. ูู ุจุชุทุจูู ุงููุฑุงูุจูู ุนูู ููุงุฐุฌู ูู ุงูุฃูุงูู ุงูุชู ุชุฑูุฏ ุถุจุทูุง.
4. ุงุฎุชุฑ ุชูููุฉ ูุนุงูุฑุฉ ููู ุจุชูููุฐูุง.
5. ูู ุจุชุญููู ุงููููุฐุฌ ุฅูู ุดููู ุงููุถุจูุท: ุชุชู ุฅุฒุงูุฉ ุงููุฑุงูุจูู ูุชุญููู ูุดุบูุงุช `float32` ุฅูู ูุธุฑุงุฆูู `int8`.
6. ููู ุงููููุฐุฌ ุงููุถุจูุท: ูู ุงูุฏูุฉ ุฌูุฏุฉ ุจูุง ููููุ ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐููุ ูุชููู ููุงุ ูุฅูุง ูุงุจุฏุฃ ูุฑุฉ ุฃุฎุฑู ูู ุงูุฎุทูุฉ 3 ูููู ุจุงุณุชุฎุฏุงู ุงูุถุจุท ุงูููู ุฃุซูุงุก ุงูุชุฏุฑูุจ ูุฐู ุงููุฑุฉ.

## ุงูุฃุฏูุงุช ุงููุฏุนููุฉ ูุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ูู ๐ค Optimum

ูููุฑ ๐ค Optimum ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (APIs) ูุฅุฌุฑุงุก ุงูุถุจุท ุงูููู ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุฎุชููุฉ ูุฃูุฏุงู ูุฎุชููุฉ:

- ุชุณูุญ ุญุฒูุฉ `optimum.onnxruntime` ุจู [ุถุจุท ููุงุฐุฌ ONNX ูุชุดุบูููุง](https://huggingface.co/docs/optimum/onnxruntime/usage_guides/quantization) ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ ONNX Runtime.
- ุชูููู ุญุฒูุฉ `optimum.intel` ูู [ุถุจุท](https://huggingface.co/docs/optimum/intel/optimization_inc) ููุงุฐุฌ ๐ค Transformers ูุน ุงุญุชุฑุงู ูููุฏ ุงูุฏูุฉ ูุงูุชุฃุฎูุฑ.
- ุชููุฑ ุญุฒูุฉ `optimum.fx` ุฃุบููุฉ ุญูู [ูุธุงุฆู ุงูุถุจุท ุงูููู PyTorch](https://pytorch.org/docs/stable/quantization-support.html#torch-quantization-quantize-fx) ููุณูุงุญ ุจุงูุถุจุท ุงูููู ููุถุน ุงูุฑุณู ุงูุจูุงูู ูููุงุฐุฌ ๐ค Transformers ูู PyTorch. ูุฐู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ููุฎูุถุฉ ุงููุณุชูู ููุงุฑูุฉ ุจุงูุงุซูุชูู ุงููุฐููุฑุชูู ุฃุนูุงูุ ููุง ูููุญู ูุฑููุฉ ุฃูุจุฑุ ููููู ูุชุทูุจ ุงููุฒูุฏ ูู ุงูุนูู ูู ุฌุงูุจู.
- ุชุณูุญ ุญุฒูุฉ `optimum.gptq` ุจู [ุถุจุท ููุงุฐุฌ LLM ูุชุดุบูููุง](../llm_quantization/usage_guides/quantization) ุจุงุณุชุฎุฏุงู GPTQ.
## ุงูุงุณุชูุงุถุฉ: ููู ุชูุซู ุงูุขูุงุช ุงูุฃุนุฏุงุฏุ

<Tip>
ูุฐุง ุงููุณู ุบูุฑ ุฃุณุงุณู ูููู ุจููุฉ ุงูููุถูุน. ููู ูุดุฑุญ ุจุฅูุฌุงุฒ ููููุฉ ุชูุซูู ุงูุฃุนุฏุงุฏ ูู ุงูุญูุงุณูุจ.
ูุจูุง ุฃู ุงูุชูููู ูุชุนูู ุจุงูุงูุชูุงู ูู ุชูุซูู ุฅูู ุขุฎุฑุ ููุฏ ูููู ูู ุงููููุฏ ูุนุฑูุฉ ุจุนุถ ุงูุฃุณุงุณูุงุชุ ููููู ุจุงูุชุฃููุฏ ููุณ ุฅูุฒุงูููุง.
</Tip>

ุฃุตุบุฑ ูุญุฏุฉ ุชูุซูู ูู ุงูุญูุงุณูุจ ูู ุงูุจุช. ูู ุดูุก ูู ุงูุญูุงุณูุจ ูููุซู ุนูู ุดูู ุณูุณูุฉ ูู ุงูุจุชุงุชุ ุจูุง ูู ุฐูู ุงูุฃุนุฏุงุฏ. ูููู ุทุฑููุฉ ุงูุชูุซูู ุชุฎุชูู ุญุณุจ ูุง ุฅุฐุง ูุงูุช ุงูุฃุนุฏุงุฏ ููุฏ ุงูููุงุด ุฃุนุฏุงุฏูุง ุตุญูุญุฉ ุฃู ุฃุนุฏุงุฏูุง ุญููููุฉ.

#### ุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ

ุนุงุฏุฉ ูุง ุชููุซู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุจุฃุทูุงู ุงูุจุชุงุช ุงูุชุงููุฉ: `8`ุ `16`ุ `32`ุ `64`. ุนูุฏ ุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉุ ููุงู ุญุงูุชุงู ูุฌุจ ูุฑุงุนุงุชููุง:

1. ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุบูุฑ ุงููููุนุฉ (ุงูุฅูุฌุงุจูุฉ): ุชููุซู ุจุจุณุงุทุฉ ุนูู ุดูู ุณูุณูุฉ ูู ุงูุจุชุงุช. ูู ุจุช ูุชูุงูู ูุน ููุฉ ุนุฏุฏ ุงุซููู (ูู `0` ุฅูู `n-1` ุญูุซ `n` ูู ุทูู ุงูุจุช)ุ ูุงูุนุฏุฏ ุงููุงุชุฌ ูู ูุฌููุน ููู ุงูุนุฏุฏ ุงุซููู ูุฐู.

ุงููุซุงู: `19` ูููุซู ุนูู ุดูู ุนุฏุฏ ุตุญูุญ ุบูุฑ ููููุน ุจุทูู 8 ุจุชุงุช `00010011` ูุฃู:

```
19 = 0 x 2^7 + 0 x 2^6 + 0 x 2^5 + 1 x 2^4 + 0 x 2^3 + 0 x 2^2 + 1 x 2^1 + 1 x 2^0
```

2. ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุงููููุนุฉ: ุฅู ุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุงููููุนุฉ ููุณ ูุจุงุดุฑูุงุ ูููุงู ุนุฏุฉ ุทุฑู ููููุงู ุจุฐููุ ุฃูุซุฑูุง ุดููุนูุง ูู ุทุฑููุฉ ุงููุชููุฉ ููุงุซููู. ููุฒูุฏ ูู ุงููุนูููุงุชุ ููููู ุงูุงุทูุงุน ุนูู ุตูุญุฉ
[ููููุจูุฏูุง](https://en.wikipedia.org/wiki/Signed_number_representations) ุญูู ูุฐุง ุงูููุถูุน.

#### ุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ

ุนุงุฏุฉ ูุง ุชููุซู ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ ุจุฃุทูุงู ุงูุจุชุงุช ุงูุชุงููุฉ: `16`ุ `32`ุ `64`.

ููุงู ุทุฑููุชุงู ุฑุฆูุณูุชุงู ูุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ:

1. ุงูููุทุฉ ุงูุซุงุจุชุฉ: ููุงู ุนุฏุฏ ุซุงุจุช ูู ุงูุฎุงูุงุช ูุญุฌูุฒ ูุชูุซูู ุงูุฌุฒุก ุงูุตุญูุญ ูุงูุฌุฒุก ุงููุณุฑู ูู ุงูุนุฏุฏ.

2. ุงูููุทุฉ ุงูุนุงุฆูุฉ: ูููู ุฃู ูุฎุชูู ุนุฏุฏ ุงูุฎุงูุงุช ุงููุณุชุฎุฏูุฉ ูุชูุซูู ุงูุฌุฒุก ุงูุตุญูุญ ูุงูุฌุฒุก ุงููุณุฑู ูู ุงูุนุฏุฏ.

ูููู ูุชูุซูู ุงูููุทุฉ ุงูุนุงุฆูุฉ ุฃู ููุซู ูุทุงูุงุช ุฃูุจุฑ ูู ุงููููุ ููุฐุง ูู ูุง ุณูุฑูุฒ ุนููู ูุฃูู ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง. ููุงู ุซูุงุซุฉ ููููุงุช ูู ุชูุซูู ุงูููุทุฉ ุงูุนุงุฆูุฉ:

1. ุจุช ุงูุฅุดุงุฑุฉ: ูุฐุง ูู ุงูุจุช ุงูุฐู ูุญุฏุฏ ุฅุดุงุฑุฉ ุงูุนุฏุฏ.

2. ุงูุฌุฒุก ุงูุฃุณูู:
- 5 ุจุชุงุช ูู `float16`
- 8 ุจุชุงุช ูู `bfloat16`
- 8 ุจุชุงุช ูู `float32`
- 11 ุจุชูุง ูู `float64`

3. ุงููููุงู:
- 11 ุจุชูุง ูู `float16` (10 ูุฎุฒูุฉ ุจุดูู ุตุฑูุญ)
- 8 ุจุชุงุช ูู `bfloat16` (7 ูุฎุฒูุฉ ุจุดูู ุตุฑูุญ)
- 24 ุจุชูุง ูู `float32` (23 ูุฎุฒูุฉ ุจุดูู ุตุฑูุญ)
- 53 ุจุชูุง ูู `float64` (52 ูุฎุฒูุฉ ุจุดูู ุตุฑูุญ)

ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุชุฎุตูุต ุงูุจุชุงุช ููู ููุน ูู ุงูุจูุงูุงุชุ ุฑุงุฌุน ุงูุฑุณู ุงูุชูุถูุญู ุนูู ุตูุญุฉ ููููุจูุฏูุง ุญูู ุชูุณูู ุงูููุทุฉ ุงูุนุงุฆูุฉ [bfloat16](https://en.wikipedia.org/wiki/Bfloat16_floating-point_format).

ุจุงููุณุจุฉ ููุนุฏุฏ ุงูุญูููู "ุณ"ุ ูุฏููุง:

```
x = sign x mantissa x (2^exponent)
```

## ุงููุฑุงุฌุน

- ูุฑูุฉ ุจุญุซูุฉ: [Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference](https://arxiv.org/abs/1712.05877)

- ููุดูุฑ ูุฏููุฉ ูููุจุชุฏุฆูู: [Basics of Quantization in Machine Learning (ML) for Beginners](https://iq.opengenus.org/basics-of-quantization-in-ml/)

- ููุดูุฑ ูุฏููุฉ: [How to accelerate and compress neural networks with quantization](https://tivadardanka.com/blog/neural-networks-quantization)

- ุตูุญุงุช ููููุจูุฏูุง ุญูู ุชูุซูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ [ููุง](https://en.wikipedia.org/wiki/Integer_(computer_science)) ู[ููุง](https://en.wikipedia.org/wiki/Signed_number_representations)

- ุตูุญุงุช ููููุจูุฏูุง ุญูู:

- [ุชูุณูู ุงูููุทุฉ ุงูุนุงุฆูุฉ bfloat16](https://en.wikipedia.org/wiki/Bfloat16_floating-point_format)

- [ุชูุณูู ุงูููุทุฉ ุงูุนุงุฆูุฉ ุจูุตู ุงูุฏูุฉ](https://en.wikipedia.org/wiki/Half-precision_floating-point_format)

- [ุชูุณูู ุงูููุทุฉ ุงูุนุงุฆูุฉ ุฐุงุช ุงูุฏูุฉ ุงููููุฑุฏุฉ](https://en.wikipedia.org/wiki/Single-precision_floating-point_format)

- [ุชูุณูู ุงูููุทุฉ ุงูุนุงุฆูุฉ ุฐุงุช ุงูุฏูุฉ ุงููุถุงุนูุฉ](https://en.wikipedia.org/wiki/Double-precision_floating-point_format)